define("2c46c8f0-e214-4f49-951e-fd5b9d7b4ae1_1.16.1",["@ms/odsp-core-bundle","@microsoft/sp-lodash-subset","@microsoft/sp-core-library","@microsoft/sp-page-context","@microsoft/sp-diagnostics"],function(n,a,i,r,o){return function(e){var t={};function n(a){if(t[a])return t[a].exports;var i=t[a]={i:a,l:!1,exports:{}};return e[a].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,a){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(n.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(a,i,function(t){return e[t]}.bind(null,i));return a},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s="mwqp")}({K9kD:function(e,t){e.exports=n},Pk8u:function(e,t){e.exports=a},QVYh:function(e,t,n){var a=n("K9kD");e.exports=a.SPAlternativeUrls},UWqr:function(e,t){e.exports=i},"X+PM":function(e,t){e.exports=r},mwqp:function(e,t,n){"use strict";n.r(t),n.d(t,"CropMode",function(){return r}),n.d(t,"ImageHelper",function(){return P}),n.d(t,"_PreviewUtility",function(){return M}),n.d(t,"_PreviewHelper",function(){return m}),n.d(t,"_SPResourcePath",function(){return p}),n.d(t,"_SPResourcePathFormat",function(){return a}),n.d(t,"_ThumbnailProviderType",function(){return f}),n.d(t,"_ThumbnailUrlGenerator",function(){return A}),n.d(t,"_UserPhotoSize",function(){return i.UserPhotoSize});var a,i=n("QVYh"),r={Default:"fit",Fit:"fit",Fill:"fill",Top:"top",Bottom:"bottom"},o=n("Pk8u"),s=n("ut3N"),c=n("UWqr"),d=n("X+PM"),l=new RegExp(/(\%[0-9][A-F])|(\%[A-F][0-9])|(\%[A-F][A-F])/g),u=new RegExp(/(\%[0-9][a-f])|(\%[a-f][0-9])|(\%[a-f][a-f])/g);!function(e){e[e.absolute=0]="absolute",e[e.relative=1]="relative",e[e.serverRelative=2]="serverRelative"}(a||(a={}));var f,p=function(){function e(e,t){void 0===e&&(e=""),t&&("/"===e[e.length-1]&&"/"===t[0]?e+=t.slice(1):"/"!==e[e.length-1]&&"/"!==t[0]?e=e+"/"+t:e+=t);var n=e.indexOf("//"),i=e.indexOf("/"),r=e.indexOf("?"),o=n>-1&&n<=i?n+"//".length:-1,s=function(e,t){if(t>-1){var n=e.indexOf("/",t);return n>-1?e.slice(0,n):e}return""}(e,o),c=s&&s.slice(o),d=c&&c.split(":")[0],l=r>0?e.slice(s.length,r):e.slice(s.length),u=s?a.absolute:"/"===l[0]?a.serverRelative:a.relative,f=l.split("/");this._originalSearchString=r>0?e.slice(r):"",this.searchParams=new URLSearchParams(this._originalSearchString),this.authority=s,this.domain=c,this.host=d,this.format=u,this.path=l,this.segments=f,this.value=e}return e._getTenantInfoFromPageContext=function(e){return e?{isMultiGeo:e.legacyPageContext.isMultiGeoTenant,multiGeoInfo:e.legacyPageContext.multiGeoInfo,singleTenant:e.legacyPageContext.vanityUrls}:void 0},e._getHostFromUrl=function(t){return t?new e(t).domain:t},e._getMySiteAndPortalDomain=function(){var e="-my",t="".concat(window.location.protocol,"//").concat(window.location.hostname),n=window.location.hostname.substr(0,window.location.hostname.indexOf("."));if(-1===n.indexOf(e,n.length-e.length))return[t.toString().replace(n,n+e),t];var a=t.toString().replace(n,n.substring(0,n.length-e.length));return[t,a]},e.prototype.toString=function(){return this.authority+this.path+this.searchParamString},e.prototype.equals=function(e){return e&&this.toString()===e.toString()},e.prototype.isInternalResource=function(t){var n=this,a=e._getTenantInfoFromPageContext(t);try{if((null==a?void 0:a.isMultiGeo)&&(null==a?void 0:a.multiGeoInfo))return a.multiGeoInfo.some(function(e){return n._isSameHost(e.PortalUrl)||n._isSameHost(e.MySiteHostUrl)||n._isSameHosts(e.AdditionalUrls)});var i=e._getMySiteAndPortalDomain();if(this._isSameHosts(i))return!0;if((null==a?void 0:a.singleTenant)&&(null==a?void 0:a.singleTenant.SingleTenant_AdditionalVanityUrls)&&-1!==a.singleTenant.SingleTenant_AdditionalVanityUrls.split(";").indexOf(this.domain))return!0;if((null==a?void 0:a.singleTenant)&&this._isInternalResourceOfSingleTenant(a.singleTenant))return!0}catch(e){return!1}return!1},e.prototype.setSearchParam=function(e,t){t?this.searchParams.set(e,decodeURIComponent(t.replace(/\+/g," "))):this.searchParams.set(e,t)},Object.defineProperty(e.prototype,"searchParamString",{get:function(){var e,t=null===(e=this.searchParams.toString())||void 0===e?void 0:e.replace(/\+/g,"%20");return t&&this._originalSearchString.match(u)&&(t=t.replace(l,function(e){return null==e?void 0:e.toLowerCase()})),t?"?"+t:t},enumerable:!1,configurable:!0}),e.prototype.getQueryParameter=function(e){var t;return null===(t=this.searchParams)||void 0===t?void 0:t.get(e)},e.prototype.removeQueryParameter=function(e){var t;null===(t=this.searchParams)||void 0===t||t.delete(e)},e.prototype._isInternalResourceOfSingleTenant=function(e){return e.SingleTenant_OneDriveUrl===this.domain||e.SingleTenant_PortalUrl===this.domain||e.SingleTenant_TeamSitesUrl===this.domain},e.prototype._isSameHost=function(t){return this.domain.toLowerCase()===e._getHostFromUrl(t).toLowerCase()},e.prototype._isSameHosts=function(e){var t=this;return!!(null==e?void 0:e.some(function(e){return t._isSameHost(e)}))},e}(),m=function(){function e(){}return e.hasThumbnailOrFileTypeSupportsPreview=function(e,t){return!!t||!!e&&M.getPreviewSupportedMap.has(e.toLowerCase())},e.getPreviewImageUrl=function(t,n,a,i,r,o,c,d,l,u,f,p){!l&&E.instance.isVROOMThumbnailEnabled()&&new s._QosMonitor("DocVizCaller").writeSuccess({service:u||"unknown"});var m=M.normalizeWidthToResolution(d);return e._generateGetPreviewImageUrl(t,a,i,r,o,c,m,l,f,p)},e._generateGetPreviewImageUrl=function(t,n,r,o,s,d,l,u,f,m){if(r){var _=new p(r);_.format===a.absolute&&(n=_.authority,r=_.path),r.indexOf("/")>=0&&(r=encodeURIComponent(r))}var h=n&&n.length?new p(n):void 0,b=n&&n.length?new p(null==h?void 0:h.authority,e.PREVIEW_HANDLER_PATH):new p(e.PREVIEW_HANDLER_PATH);void 0===l||isNaN(l)||b.searchParams.set(e.RESOLUTION,l.toString());var g=c.Guid.tryParse(o),v=c.Guid.tryParse(s),y=c.Guid.tryParse(d),S="True"===i.tryGetAlternativeUrl("PrivateCDNEnabled"),D=g&&v&&y&&!k.has(d)&&!k.has(s)&&!k.has(o),I=S&&c._SPFlight.isEnabled(60134)&&u&&!!r&&b.toString().length+encodeURIComponent(r).length<=255,x=!1;if(D&&!I)b.searchParams.set(e.GUID_SITE,g.toString().replace(/-/g,"")),b.searchParams.set(e.GUID_WEB,v.toString().replace(/-/g,"")),b.searchParams.set(e.GUID_FILE,y.toString().replace(/-/g,""));else{if(!r)return;b.setSearchParam(e.PATH,r),x=!0}return u||b.searchParams.set(M.CLIENT_TYPE,M.MODERN_WEB_PART),u&&t&&!x&&(b.searchParams.set(e.EXT,t),b.toString().length>=255&&b.searchParams.delete(e.EXT)),u&&f&&m&&(b.searchParams.set(e.ORIGINAL_WIDTH,f.toString()),b.searchParams.set(e.ORIGINAL_HEIGHT,m.toString()),b.toString().length>=255&&(b.searchParams.delete(e.ORIGINAL_WIDTH),b.searchParams.delete(e.ORIGINAL_HEIGHT))),b.toString()},e.RESOLUTION="resolution",e.GUID_SITE="guidSite",e.GUID_WEB="guidWeb",e.GUID_FILE="guidFile",e.PATH="path",e.EXT="ext",e.ORIGINAL_WIDTH="ow",e.ORIGINAL_HEIGHT="oh",e.WIDTH="width",e.WIDTH_SHORT="w",e.HEIGHT_SHORT="h",e.VIEWPORT_LEFT="vl",e.VIEWPORT_TOP="vt",e.VIEWPORT_WIDTH="vw",e.VIEWPORT_HEIGHT="vh",e.CALLER_STACK="cs",e.INPUT_FORMAT="inputFormat",e.DOCID="docid",e.PREVIEW_HANDLER_PATH="/_layouts/15/getpreview.ashx",e.VIDEO_EXTENSIONS=["3gp","asf","avi","mod","mov","mp4","mpeg","mpg","mts","ts","vob","wmv"],e.IMAGE_EXTENSIONS=["gif","jpg","jpeg","bmp","dib","tif","tiff","ico","png","jxr","svg"],e}();!function(e){e[e.Unknown=0]="Unknown",e[e.PrivateCDN=1]="PrivateCDN",e[e.AFDPrivateCDN=2]="AFDPrivateCDN",e[e.DocViz=3]="DocViz",e[e.MeTA=4]="MeTA",e[e.MySite=5]="MySite",e[e.Original=6]="Original",e[e.SharePointHost=7]="SharePointHost",e[e.Stock=8]="Stock",e[e.VROOMMeTACache=9]="VROOMMeTACache",e[e.PublicCDN=10]="PublicCDN",e[e.External=11]="External",e[e.MediaCDNDefault=12]="MediaCDNDefault",e[e.MediaCDNHubble=13]="MediaCDNHubble",e[e.HubbleStock=14]="HubbleStock",e[e.HubbleStockThumbnail=15]="HubbleStockThumbnail",e[e.SPOLayoutsImage=16]="SPOLayoutsImage",e[e.MediaCDNLayoutsImage=17]="MediaCDNLayoutsImage",e[e.MediaCDNOptimalLayoutsImage=18]="MediaCDNOptimalLayoutsImage"}(f||(f={}));var _=n("K9kD"),h=/(\/thumbnails\/\d\/(.*?)\/content\/?(|(\?(.*?)))$)/i,b=/(.svc.ms\/transform\/thumbnail\/?(|(\?(.*?)))$)/i,g=/(privatecdn(.*?).sharepointonline.com\/(.*?)\?(.*?)(_oat_=(.*?)|AuthVer=2)(.*?)$)/i,v=/(publiccdn(.*?).sharepointonline.com\/(.*?)$)/i,y=/(\/_vti_bin\/afdcache.ashx\/?(|(\/(.*?)))$)/i,S=/(\/_layouts\/15\/getpreview.ashx\/?(|(\?(.*?)))$)/i,D="MediaTAThumbnailHostUrl",I="media.akamai.odsp.cdn.office.net",x="https://".concat(I),C="cdn.hubblecontent.osi.office.net",O=(new Set).add("modern.akamai.odsp.cdn.office.net").add("az741266.vo.msecnd.net").add("spoprod-a.akamaihd.net").add("spoppe-a.akamaihd.net").add("az742526.vo.msecnd.net").add("spoppe-b.akamaized.net").add("spoppe-b.azureedge.net").add("spoppe-b2.azureedge.net").add("modernb.akamai.odsp.cdn.office.net").add("modernb.verizon.odsp.cdn.office.net").add("res-1-sdf.cdn.office.net").add("res-2-sdf.cdn.office.net").add("res-1.cdn.office.net").add("res-2.cdn.office.net").add("resourceseng.blob.core.windows.net").add("odspwebdevdeploy.blob.core.windows.net"),w="docid",E=function(){function e(){var e=this;this._initialize=function(t){var n,a;e._pageContext=e._serviceScope.consume(d.PageContext.serviceKey);var r=e._pageContext,o=(null==r?void 0:r.legacyPageContext)||(null==r?void 0:r._legacyPageContext);if(o){var s=i.getUrlTable();o.MediaTAServiceHostUrl&&!s.MediaTAThumbnailHostUrl&&(s.MediaTAThumbnailHostUrl=o.MediaTAServiceHostUrl),o.userPhotoCdnBaseUrl&&!s.UserPhotoAspx&&(s.UserPhotoAspx=o.userPhotoCdnBaseUrl)}!c._SPKillSwitch.isActivated("9748ceb6-d312-4141-9733-b29ac48f8bcd")&&(null===(a=null===(n=null==t?void 0:t.page)||void 0===n?void 0:n.Content)||void 0===a?void 0:a.AlternativeUrlMap)&&i.updateMap(t.page.Content.AlternativeUrlMap)},this._logSource=s._LogSource.create("ThumbnailUrlGenerator")}return e._isFileTypeSupportedByMediaService=function(e){return c._SPKillSwitch.isActivated("991c0e1c-05b0-4ecb-af32-6eefb92fe9d7")||(M.mediaServiceSupportedMap.delete("svg"),M.mediaServiceSupportedMap.delete("svgz")),!!e&&M.mediaServiceSupportedMap.has(e.toLowerCase())},e._isViewportNumberValid=function(e){return void 0!==e&&!isNaN(e)},e._isMySiteHost=function(e,t){var n="-my.",a=e.domain.toLowerCase();return a.indexOf(n)>-1&&a.replace(n,".")===t.domain.toLowerCase()},e._replaceQueryValue=function(e,t,n){return void 0!==n?e.setSearchParam(t,n.toString()):e.searchParams.delete(t),e.toString()},e._getSPResourceAuthority=function(e){var t=new p(e.absoluteUrl||"");if(e.spResource){var n=new p(e.spResource);return n.format===a.relative||n.format===a.serverRelative?t:new p(n.authority)}return t},Object.defineProperty(e,"instance",{get:function(){return void 0===this._instance&&(this._instance=new e),this._instance},enumerable:!1,configurable:!0}),e.prototype.initialize=function(e,t){var n=this;this._serviceScope||(this._serviceScope=e,this._serviceScope.whenFinished(function(){return n._initialize(t)})),t&&void 0!==t.MediaTAForThumbnail&&(this._mediaTAForThumbnailEnabled=!!t.MediaTAForThumbnail)},e.prototype.isFileTypeSupported=function(t){if(!t)return!1;var n=t.toLowerCase();return"svg"!==n&&(M.getPreviewSupportedMap.has(n)||this.isVROOMThumbnailEnabled()&&(e._isFileTypeSupportedByMediaService(n)||"aspx"===n))},e.prototype.getUserPhotoUrl=function(e,t){return void 0===t&&(t=i.UserPhotoSize.Small),i.getUserPhotoUrl(e,t)},e.prototype.getThumbnailUrl=function(e,t){if(!e)throw new Error("Input parameter request is ".concat(e));if(e.unknownThumbnailUrl)return this._fromUnknownThumbnailUrl(e,t);e.spResource&&(e.spResource=this._pruneShareUrl(e.spResource));var n,a=this._isViewportParametersSpecified(e);if(!a){var r=this._getPreLoadedImage(e);if(r)return r}if(a&&e.originalWidth&&e.originalHeight&&(e.viewportWidth=Math.min(e.viewportWidth,e.originalWidth-e.viewportLeft),e.viewportHeight=Math.min(e.viewportHeight,e.originalHeight-e.viewportTop)),e.spResource)switch(n=this.getThumbnailProvider(e.spResource,!!t)){case f.DocViz:return this.fromGetPreview(e.spResource,e.callerId,e.width);case f.PrivateCDN:case f.AFDPrivateCDN:if(i.isAlterantiveUrlFresh(e.spResource))return this.updateThumbnailWidth(e.spResource,e.width,n);e.spResource=this._getPathFromOptimalUrl(n,e.spResource),n=f.SharePointHost;break;case f.MeTA:case f.VROOMMeTACache:case f.PublicCDN:case f.MediaCDNDefault:case f.MediaCDNHubble:case f.MediaCDNOptimalLayoutsImage:return this.updateThumbnailWidth(e.spResource,e.width,n);case f.External:case f.MediaCDNLayoutsImage:return this._enableStockImageThumbnailFlight()?this._getPublicCDNMeTAUrl(e.spResource,e):e.spResource;case f.HubbleStockThumbnail:return this._updateHubbleThumbnailWidth(e);case f.HubbleStock:return this._getPublicCDNMeTAUrl(e.spResource,e);case f.SPOLayoutsImage:return this._enableStockImageThumbnailFlight()?this._getPublicCDNMeTAUrl(this._rewriteOptimalLayoutsImageUrl(e),e):this._rewriteOptimalLayoutsImageUrl(e)}if(t||n===f.Stock)return this._getPublicCDNMeTAUrl(t||e.spResource,e);if(this._isLayoutsPath(e.spResource))return e.spResource;var o=!1;if(e.fileType&&(o="aspx"===e.fileType.toLowerCase()),e.thumbnail&&!o)return e.thumbnail;var s=this.getCDNUrl(e);return s||(this.getVROOMThumbnailUrl(e,n)||this.getDocVizUrl(e,n)||e.spResource)},Object.defineProperty(e.prototype,"publicCDNBaseUrl",{get:function(){var e,t;return null===(t=null===(e=this._pageContext)||void 0===e?void 0:e.legacyPageContext)||void 0===t?void 0:t.publicCdnBaseUrl},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mediaCDNBaseUrl",{get:function(){return x},enumerable:!1,configurable:!0}),e.prototype.getVROOMThumbnailUrl=function(t,n){if(!t)throw new Error("Input parameter request is ".concat(t));var i,o=!!t.fileType&&"aspx"===t.fileType.toLowerCase(),s=t.spResource;if(s){if((n=n||t.spResource&&this.getThumbnailProvider(t.spResource))===f.VROOMMeTACache)return M.updateVROOMCustomThumbnailSize(t.spResource,t.width);switch(n){case f.MeTA:s=void 0;break;case f.PrivateCDN:case f.PublicCDN:var d=new p(t.spResource);s=(s="https:/".concat(d.path)).split("?")[0];break;case f.AFDPrivateCDN:var l=new p(t.spResource);s=(s="".concat(l.authority).concat(l.path.substr("/_vti_bin/afdcache.ashx/authitem".length))).split("?")[0];break;case f.SharePointHost:case f.MySite:s=t.spResource;break;case f.External:case f.Stock:case f.HubbleStock:case f.HubbleStockThumbnail:case f.SPOLayoutsImage:case f.MediaCDNDefault:case f.MediaCDNHubble:default:s=void 0}new p(s).format===a.absolute&&(i=new p(s))}var u=!t.fileType,m=this._isViewportParametersSpecified(t);if((o||e._isFileTypeSupportedByMediaService(t.fileType)||u)&&this.isVROOMThumbnailEnabled()&&!c._SPKillSwitch.isActivated("318c1916-4594-4509-8ab7-cdb100182007")){i=i||e._getSPResourceAuthority(t);var _=M.getVROOMItemUrl(t.siteId,t.webId,t.listId,t.uniqueId,i.authority,i.host,s),h=t.cropMode&&t.cropMode!==r.Default;return m||h?M.getVROOMThumbnailUrl(_,t.width,t.height,void 0,t.originalWidth,t.originalHeight,t.cropMode,t.viewportTop,t.viewportLeft,t.viewportWidth,t.viewportHeight):M.getVROOMThumbnailUrl(_,t.width,t.height)}},e.prototype.getCDNUrl=function(e){if(!e)throw new Error("Input parameter request is ".concat(e));if(e.spResource)return M.getAlternateUrl(new p(e.spResource),e.width,e.height,e.originalWidth,e.originalHeight,e.cropMode,e.viewportTop,e.viewportLeft,e.viewportWidth,e.viewportHeight)},e.prototype.getDocVizUrl=function(e,t){if(!e)throw new Error("Input parameter request is ".concat(e));if(e.spResource&&(e.spResource=this._getPathFromOptimalUrl(t||this.getThumbnailProvider(e.spResource),e.spResource)),!c._SPKillSwitch.isActivated("67d7e188-b33c-4fc2-8862-a072c6d8afb4")&&this.isFileTypeSupported(e.fileType))return this._fallbackToGetPreview(e)},e.prototype.updateThumbnailWidth=function(t,n,a){if(!t||void 0===n||isNaN(n)||n<=0)return t;var i=M.normalizeWidth(n),r=new p(t);if(r.searchParams.has(m.WIDTH_SHORT))return e._replaceQueryValue(r,m.WIDTH_SHORT,i);if(r.searchParams.has(m.WIDTH))return e._replaceQueryValue(r,m.WIDTH,i);if(r.searchParams.has(m.RESOLUTION))return e._replaceQueryValue(r,m.RESOLUTION,M.normalizeWidthToResolution(n));switch(a=a||this.getThumbnailProvider(t)){case f.External:return t;case f.VROOMMeTACache:return M.updateVROOMCustomThumbnailSize(t,n);case f.PrivateCDN:case f.PublicCDN:case f.AFDPrivateCDN:case f.MediaCDNDefault:case f.MediaCDNHubble:case f.MeTA:return"".concat(t).concat(-1===t.indexOf("?")?"?":"&").concat(m.WIDTH,"=").concat(i);case f.DocViz:return"".concat(t,"&").concat(m.RESOLUTION,"=").concat(M.normalizeWidthToResolution(n));case f.HubbleStockThumbnail:return this._updateHubbleThumbnailWidth({spResource:t,width:n,absoluteUrl:"",callerId:"updateWidth"});case f.SharePointHost:case f.MySite:if(this.isFileTypeSupported(M.getFileExtension(new p(t))))return"".concat(t).concat(-1===t.indexOf("?")?"?":"&").concat(m.WIDTH,"=").concat(i)}return s._TraceLogger.logError(this._logSource,new Error("Could not add width to the URL"),"updateThumbnailWidth"),t},e.prototype.getThumbnailWidth=function(e,t){if(""!==e)try{var n=new p(e);if(n.searchParams.has(m.WIDTH_SHORT))return Number(n.searchParams.get(m.WIDTH_SHORT));if(n.searchParams.has(m.WIDTH))return Number(n.searchParams.get(m.WIDTH));if(n.searchParams.has(m.RESOLUTION))return M.getWidthByResolution(Number(n.searchParams.get(m.RESOLUTION)));switch(t=t||this.getThumbnailProvider(e)){case f.External:return;case f.VROOMMeTACache:return M.getVROOMThumbnailWidth(e);case f.PrivateCDN:case f.PublicCDN:case f.AFDPrivateCDN:case f.MediaCDNDefault:case f.MediaCDNHubble:case f.MeTA:return 0;case f.DocViz:return 300;case f.SharePointHost:case f.MySite:case f.Stock:return 0;case f.HubbleStockThumbnail:return 300}s._TraceLogger.logError(this._logSource,new Error("Could not find for given URL"),"getThumbnailWidth")}catch(e){}},e.prototype.getThumbnailProvider=function(t,n){var i,r;if(!t)return f.Unknown;var o=new p(t);if(n||0===t.indexOf("/_LAYOUTS/IMAGES/"))return(null===(i=o.host)||void 0===i?void 0:i.toLowerCase())===I?f.MediaCDNDefault:f.Stock;if(o.host===C)return o.searchParams.has("file")&&o.path.indexOf("/thumbnails/")>0?f.HubbleStockThumbnail:f.HubbleStock;if(O.has(o.host))return f.Stock;if(h.test(t))return f.VROOMMeTACache;if((null===(r=o.host)||void 0===r?void 0:r.toLowerCase())===I){var s=o.getQueryParameter(w);return s?(null==s?void 0:s.indexOf(C))>-1?f.MediaCDNHubble:this._enableStockImageThumbnailFlight()&&this.isLayoutsImage(s)?f.MediaCDNOptimalLayoutsImage:f.MediaCDNDefault:f.MediaCDNLayoutsImage}if(b.test(t))return f.MeTA;if(g.test(t))return f.PrivateCDN;if(v.test(t))return f.PublicCDN;if(y.test(t))return f.AFDPrivateCDN;if(S.test(t))return f.DocViz;if(this.isLayoutsImage(t))return f.SPOLayoutsImage;var c=new p(window.location.href);if(e._isMySiteHost(o,c))return f.MySite;var d=o.host||"",l=c.host.toLowerCase();return d.toLowerCase()===l||o.format!==a.absolute?f.SharePointHost:o.format===a.absolute&&this._pageContext?o.isInternalResource(this._pageContext)?f.SharePointHost:f.External:f.Unknown},e.prototype.isCdnUrl=function(e){var t=this.getThumbnailProvider(e);return t===f.PrivateCDN||t===f.PublicCDN||t===f.AFDPrivateCDN},e.prototype.fromGetPreview=function(e,t,n){if(void 0===n&&(n=400),e&&S.test(e)){var a=new p(e),i=a.authority;(!i||i.length<5)&&(i=new p(window.location.href).authority);var r={fileType:a.searchParams.get(m.EXT)||void 0,absoluteUrl:i,spResource:a.searchParams.get(m.PATH)||void 0,siteId:a.searchParams.get(m.GUID_SITE)||void 0,webId:a.searchParams.get(m.GUID_WEB)||void 0,uniqueId:a.searchParams.get(m.GUID_FILE)||void 0,width:n,callerId:t};if(!r.fileType&&r.spResource){var o=new p(r.spResource);r.fileType=M.getFileExtension(o)}return this.getThumbnailUrl(r)||e}},e.prototype.isVROOMThumbnailEnabled=function(){return!c._SPKillSwitch.isActivated("aaa0d161-5c00-4be4-98d2-7147c13548fc")||!!this._mediaTAForThumbnailEnabled},e.prototype.isLayoutsImage=function(e){return!!e&&e.toLowerCase().indexOf("_layouts/15/images/")>-1},e.prototype._pruneShareUrl=function(e){return e.replace(/\/:\w:\/\w/,"")},e.prototype._fromUnknownThumbnailUrl=function(e,t){var n=this.getThumbnailProvider(e.unknownThumbnailUrl,!!t);switch(n){case f.DocViz:return this.fromGetPreview(e.unknownThumbnailUrl,e.callerId,e.width);case f.MeTA:case f.VROOMMeTACache:case f.PrivateCDN:case f.PublicCDN:case f.AFDPrivateCDN:case f.MediaCDNDefault:case f.MediaCDNHubble:return this.updateThumbnailWidth(e.unknownThumbnailUrl,e.width,n);case f.SharePointHost:case f.MySite:case f.HubbleStock:case f.HubbleStockThumbnail:case f.Stock:case f.SPOLayoutsImage:return e.spResource||(e.spResource=e.unknownThumbnailUrl),e.unknownThumbnailUrl=void 0,this.getThumbnailUrl(e,t);case f.Unknown:default:return e.unknownThumbnailUrl}},e.prototype._isViewportParametersSpecified=function(t){return e._isViewportNumberValid(t.viewportHeight)&&e._isViewportNumberValid(t.viewportWidth)&&e._isViewportNumberValid(t.viewportTop)&&e._isViewportNumberValid(t.viewportLeft)},e.prototype._fallbackToGetPreview=function(e){return m.getPreviewImageUrl(e.fileType,e.thumbnail,e.absoluteUrl,e.spResource,e.siteId,e.webId,e.uniqueId,e.width,!1,e.callerId)},e.prototype._getPreLoadedImage=function(e){var t=void 0;if(e&&e.spResource){var n=this._getPreloadedDictionary();if(n&&!(t=this._readUrlFromDictionary(n,e.spResource))){var a=new p(e.spResource).path;a&&(t=this._readUrlFromDictionary(n,a))}}if(c._SPFlight.isEnabled(1994)&&t){var i=t.split("?");if(i[1]&&i[1].indexOf("AuthVer=")>-1)return e.width=Math.max(this.getThumbnailWidth(t,f.PrivateCDN),e.width),this.getCDNUrl(e)}return this._validateResolution(t,e)?t:void 0},e.prototype._getPreloadedDictionary=function(){var e=window._preloadImages;if(e&&!this._isDecodedKeyAdded)for(var t in this._isDecodedKeyAdded=!0,e)if(t){var n=void 0;try{n=decodeURIComponent(t)}catch(e){n=t}n!==t&&(e[n]=e[t])}return e},e.prototype._getPublicCDNMeTAUrl=function(e,t){if(this.mediaCDNBaseUrl){var n=new p(e);if(this._enableStockImageThumbnailFlight()){if(!O.has(n.host)&&n.host!==C&&!this.isLayoutsImage(n.path))return e}else if(!O.has(n.host)&&n.host!==C)return e;if(i.tryGetAlternativeUrl(D)){var a=t.width?M.normalizeWidth(t.width,!0):L,o=t.fileType||M.getFileExtension(n),s=new p(i.tryGetAlternativeUrl(D)),c="".concat(this.mediaCDNBaseUrl,"/").concat(s.domain,"/transform/thumbnail?provider=url&inputFormat=").concat(o,"&docid=").concat(encodeURIComponent(e),"&w=").concat(a),d=!!t.height&&!!t.cropMode&&t.cropMode!==r.Default,l=this._isViewportParametersSpecified(t);return d?c="".concat(c,"&h=").concat(t.height,"&cm=").concat(t.cropMode):t.height&&(c="".concat(c,"&h=").concat(t.height)),l&&(c="".concat(c,"&vl=").concat(t.viewportLeft,"&vt=").concat(t.viewportTop,"&vw=").concat(t.viewportWidth,"&vh=").concat(t.viewportHeight)),c}}return e},e.prototype._validateResolution=function(e,t){if(!e)return!1;if(!t.width)return!0;var n=new p(e).searchParams.get("resolution")||void 0;if(n){var a=M.normalizeWidthToResolution(t.width),i=Number(n);return this._validateImageProperty(a,i,"Resolution",t.callerId)}var r=this.getThumbnailWidth(e);if(r){var o=M.normalizeWidth(t.width);return this._validateImageProperty(o,r,"Width",t.callerId)}return!0},e.prototype._validateImageProperty=function(e,t,n,a){var i="ImagePreload",r=void 0;return void 0===e?r="".concat(i).concat(n,"Missing"):!isNaN(t)&&e>t&&(r="".concat(i).concat(n,"Mismatch")),r&&new s._QosMonitor("ImagePreloadMismatch").writeUnexpectedFailure(r),!r},e.prototype._readUrlFromDictionary=function(e,t){try{return e[t]||e[decodeURIComponent(t)]}catch(e){return}},e.prototype._isLayoutsPath=function(e){return!!e&&e.toLowerCase().indexOf("/_layouts/15/")>-1},e.prototype._rewriteOptimalLayoutsImageUrl=function(e){var t=e.spResource.toLowerCase(),n=new p(t);if(n.format!==a.absolute){var i=new p(e.absoluteUrl||location.href),r=t.substring(t.indexOf("/_layouts/15/"));return _.Uri.concatenate(this.mediaCDNBaseUrl,i.domain,r)}return r=n.path.substring(n.path.indexOf("/_layouts/15/")),_.Uri.concatenate(this.mediaCDNBaseUrl,n.domain,r)},e.prototype._getPathFromOptimalUrl=function(e,t){var n=new p(t),a=t;if(e===f.PrivateCDN||e===f.PublicCDN||e===f.MediaCDNLayoutsImage)a=(a="https:/".concat(n.path)).split("?")[0];else if(e===f.AFDPrivateCDN)a=(a="".concat(n.authority).concat(n.path.substr("/_vti_bin/afdcache.ashx/authitem".length))).split("?")[0];else if(e===f.VROOMMeTACache){var i="/sharepoint:/",r="/shares/u!",o="/driveitem/thumbnails/",s=":".concat(o),c=t.toLowerCase(),d=-1===(u=c.indexOf(i))?-1:c.indexOf(s);u>-1&&d>-1?a=t.substring(u+i.length-1,d):(d=-1===(u=c.indexOf(r))?-1:c.indexOf(o),u>-1&&d>-1&&(a=decodeURIComponent(escape(atob(t.substring(u+r.length,d))))))}else if(e===f.MediaCDNDefault||e===f.MediaCDNHubble)a=decodeURIComponent(n.getQueryParameter(w));else if(e===f.DocViz){var l=n.getQueryParameter("path");if(l){a=l="/"===(l=decodeURIComponent(l))[0]?l:"/".concat(l);var u,m=n.path.split("/_layouts/15/")[0];m.length>0&&(-1===(u=l.indexOf(m))||u>1)&&(a="".concat(m).concat(l))}}return a},e.prototype._updateHubbleThumbnailWidth=function(e){if(e.width<=300||!i.tryGetAlternativeUrl(D))return e.spResource;var t=new p(e.spResource),n="".concat(e.spResource.split("/thumbnails/")[0],"/").concat(t.getQueryParameter("file"));return this._getPublicCDNMeTAUrl(n,e)},e.prototype._enableStockImageThumbnailFlight=function(){return c._SPFlight.isEnabled(60842)},e}(),A=E.instance,L=400,k=(new Set).add("00000000-0000-0000-0000-000000000000").add("00000000000000000000000000000000").add("{00000000-0000-0000-0000-000000000000}").add("{00000000000000000000000000000000}"),M=function(){function e(){}return Object.defineProperty(e,"smallestBreakPointWidth",{get:function(){return L},enumerable:!1,configurable:!0}),Object.defineProperty(e,"getPreviewSupportedMap",{get:function(){return e._getPreviewSupportedMap},enumerable:!1,configurable:!0}),e.getAlternateUrl=function(t,n,a,r,o,s,d,l,u,f){if(!c._SPKillSwitch.isActivated("c2151f9e-ff03-4fa5-8852-10f75e817d4e")){var m=i.tryGetAlternativeUrl(t.value)||i.tryGetAlternativeUrl(encodeURI(t.value));if(!m)try{m=i.tryGetAlternativeUrl(decodeURI(t.value))}catch(e){}if(!m&&t.authority){var _=t.path;if(!(m=i.tryGetAlternativeUrl(_)||i.tryGetAlternativeUrl(encodeURI(_))))try{m=i.tryGetAlternativeUrl(decodeURI(_))}catch(e){}}if(m&&void 0!==n&&!isNaN(n)&&A.isFileTypeSupported(e.getFileExtension(t))){var h=new p(m);if((void 0===a||isNaN(a))&&(n=e.normalizeWidth(n)),void 0!==n&&h.searchParams.set("width",Math.round(n).toString()),void 0!==a&&!isNaN(a)){var b=e.normalizeHeight(a);void 0!==b&&h.searchParams.set("height",b.toString())}void 0!==d&&void 0!==l&&void 0!==u&&void 0!==f&&(h.searchParams.set(e.VIEWPORT_PARAMETER_LEFT,l.toString()),h.searchParams.set(e.VIEWPORT_PARAMETER_TOP,d.toString()),h.searchParams.set(e.VIEWPORT_PARAMETER_WIDTH,u.toString()),h.searchParams.set(e.VIEWPORT_PARAMETER_HEIGHT,f.toString())),void 0!==s&&h.searchParams.set(e.CROPMODE_PARAMETER,s),void 0!==r&&void 0!==o&&(h.searchParams.set(e.ORIGINAL_WIDTH_PARAMETER,r.toString()),h.searchParams.set(e.ORIGINAL_HEIGHT_PARAMETER,o.toString())),m=h.toString()}return m}},e.normalizeWidth=function(t,n){return void 0===n&&(n=!1),e._getWidthByMeTACache(Math.round(t),n)},e.normalizeHeight=function(e){return e?Math.round(e):void 0},e.normalizeWidthToResolution=function(t){return e._widthToResolution(Math.round(t))},e.isImage=function(t){return e._imageExtensions||(e._imageExtensions={},e._createLookupEntries(m.IMAGE_EXTENSIONS,e._imageExtensions)),!!t&&!!e._imageExtensions[t.toLowerCase()]},e.isVideo=function(t){return e._videoExtensions||(e._videoExtensions={},e._createLookupEntries(m.VIDEO_EXTENSIONS,e._videoExtensions)),!!t&&!!e._videoExtensions[t.toLowerCase()]},e.getVROOMThumbnailUrl=function(t,n,a,i,r,o,s,c,d,l,u){var f,p,m=99999,_=this.normalizeDimension(n,a,i);if(t){_.width||_.height?(f=_.width||m,p=_.height||m):(f=e.smallestBreakPointWidth,p=m);var h=void 0!==d&&void 0!==c&&void 0!==l&&void 0!==u?"&".concat(e.VIEWPORT_PARAMETER_LEFT,"=").concat(d,"&").concat(e.VIEWPORT_PARAMETER_TOP,"=").concat(c,"&").concat(e.VIEWPORT_PARAMETER_WIDTH,"=").concat(l,"&").concat(e.VIEWPORT_PARAMETER_HEIGHT,"=").concat(u):"",b=void 0!==n&&void 0!==a&&void 0!==s?"&".concat(e.CROPMODE_PARAMETER,"=").concat(s):"",g=void 0!==r&&void 0!==o?"&".concat(e.ORIGINAL_WIDTH_PARAMETER,"=").concat(r,"&").concat(e.ORIGINAL_HEIGHT_PARAMETER,"=").concat(o):"";return"".concat(t,"/thumbnails/0/c").concat(f,"x").concat(p,"/content?preferNoRedirect=true&").concat(e.PREFER,"=").concat(e.EXTEND_CACHE_MAXAGE,"&").concat(e.CLIENT_TYPE,"=").concat(e.MODERN_WEB_PART).concat(h).concat(b).concat(g)}},e.getVROOMItemUrl=function(e,t,n,i,r,d,l,u){var f;if(!(r&&d&&e&&t&&n&&i)||k.has(i)||k.has(e)||k.has(n)||k.has(t)){if(r&&d&&e&&t&&i&&!k.has(i)&&!k.has(e)&&!k.has(t))f=(f=(f=(f="{.spHost}/_api/v2.1/sites/{DomainName},{SPSite.Id},{SPWeb.Id}/items/{SPListItem.UniqueId}/driveItem".replace("{.spHost}",r)).replace("{DomainName}",d)).replace("{SPSite.Id}",e)).replace("{SPWeb.Id}",t),i=o.trimEnd(o.trimStart(i,"{"),"}"),f=f.replace("{SPListItem.UniqueId}",i);else if(r&&l){l.indexOf("?")>-1&&(new s._QosMonitor("ThumbnailRequestWithQuery").writeSuccess({service:u||"Unknown",source:l}),l=l.split("?")[0]),l.indexOf("#")>-1&&new s._QosMonitor("ThumbnailRequestWithHash").writeSuccess({service:u||"Unknown",source:l});var m=new p(l),_=l;(_.indexOf("%2F")>-1||_.indexOf("%2f")>-1)&&(_=decodeURIComponent(_)),m.format!==a.absolute&&(_="".concat(r).concat("/"!==_[0]&&"\\"!==_[0]?"/":"").concat(_));var h=c._SPKillSwitch.isActivated("2f268f84-0eee-4f0f-a743-fec73e5e76b2")?c._SPKillSwitch.isActivated("f1135e46-8b4b-41c8-9af2-008a1596012d")?o.trimEnd(o.trimEnd(btoa(unescape(encodeURIComponent(_))),"="),"=".replace("+","-").replace("/","_")):o.trimEnd(btoa(unescape(encodeURIComponent(_))),"=").replace("+","-").replace("/","_"):o.trimEnd(btoa(unescape(encodeURIComponent(_))),"=").replace(/\+/g,"-").replace(/\//g,"_");f="{.spHost}/_api/v2.1/shares/u!{.base64EncodedResourceUrl}/driveItem".replace("{.spHost}",r).replace("{.base64EncodedResourceUrl}",h)}}else f=(f=(f=(f="{.spHost}/_api/v2.1/sites/{DomainName},{SPSite.Id},{SPWeb.Id}/lists/{SPList.Id}/items/{SPListItem.UniqueId}/driveItem".replace("{.spHost}",r)).replace("{DomainName}",d)).replace("{SPSite.Id}",e)).replace("{SPWeb.Id}",t),n=o.trimEnd(o.trimStart(n,"{"),"}"),f=f.replace("{SPList.Id}",n),i=o.trimEnd(o.trimStart(i,"{"),"}"),f=f.replace("{SPListItem.UniqueId}",i);return f},e.updateVROOMCustomThumbnailSize=function(t,n){if(!t||isNaN(n)||n<=0)return t;var a=t.toLowerCase().indexOf(e.THUMBNAIL_SIZE_PREFIX);if(a<0)return t;var i=t.indexOf("x",a+e.THUMBNAIL_SIZE_PREFIX.length);if(i<=a)return t;var r=t.substr(a,i-a);return t.replace(r,"".concat(e.THUMBNAIL_SIZE_PREFIX).concat(this.normalizeWidth(n)))},e.getVROOMThumbnailWidth=function(t){if(""!==t){var n=t.toLowerCase().indexOf(e.THUMBNAIL_SIZE_PREFIX);if(!(n<0)){var a=t.indexOf("x",n+e.THUMBNAIL_SIZE_PREFIX.length);if(!(a<=n))return n+=e.THUMBNAIL_SIZE_PREFIX.length,Number(t.substr(n,a-n))}}},e.normalizeDimension=function(t,n,a){return!n&&t?t=e.normalizeWidth(t):n&&!t?n=e.normalizeWidth(n):t&&n?(t=Math.round(t),n=Math.round(n)):t=void 0!==a?this.getWidthByResolution(a):e.smallestBreakPointWidth,{width:t,height:n}},e.getFileExtension=function(e){if(e){var t=e.path.lastIndexOf(".");return t>-1?e.path.substr(t+1).toLowerCase():void 0}},e.getWidthByResolution=function(e){if(isNaN(e))return 300;var t=300;switch(e){case 0:t=300;break;case 1:t=480;break;case 2:t=750;break;case 3:t=1024;break;case 4:t=1600;break;case 5:case 6:t=2560}return t},e._widthToResolution=function(e){if(void 0!==e&&!isNaN(e))return e<=300?0:e<=480?1:e<=750?2:e<=1024?3:e<=1600?4:5},e._createLookupEntries=function(e,t){for(var n=0;n<e.length;n++)t[e[n]]=!0},e._getWidthByMeTACache=function(t,n){void 0===n&&(n=!1);var a=e.smallestBreakPointWidth;return void 0===t||isNaN(t)?a:n&&t<=200?200:t<=a?a:t<=960?960:t<=1600?1600:2560},e.CLIENT_TYPE="clientType",e.MODERN_WEB_PART="modernWebPart",e.PREFER="prefer",e.EXTEND_CACHE_MAXAGE="extendCacheMaxAge",e.THUMBNAIL_SIZE_PREFIX="/thumbnails/0/c",e.mediaServiceSupportedMap=new Set(["doc","docx","xlsb","xlsx","xlsm","xltx","xls","ppt","pptx","pptm","potx","potm","pot","ppsx","ppsxm","pps","odt","ods","odp","rtf","csv","pano","fppx","hcp","eml","msg","ai","cur","epdf","epi","eps","epsf","epsi","ico","icon","log","mat","pdf","pdfa","pict","ps","psb","psd","svg","svgz","txt","xbm","xcf","xpm","mts","m2ts","mpg","mpeg","mp4","mov","wmv","avi","asf","m4v","3gp","3g2","3gp2","3gpp","m1v","m2v","ts","mp4v","ogg","webm","movie","bmp","png","jpeg","jpg","jfif","tiff","tif","wmp","arw","cr2","erf","mef","mrw","nef","orf","nrw","pef","raw","rw2","rw1","sr2","cool","fbx","obj","ply","stl","3mf","glb","dcm","dcm30","dic","dicm","dicom"]),e._browserViewableImageExtensions=["bmp","jpeg","jpg","png","svg","tif","tiff"],e._getPreviewSupportedMap=new Set(["3gp","3g2","3gp2","asf","ai","aspx","avi","docm","docx","dotx","dotm","dv","emf","eps","ismv","m2v","m2ts","mov","mod","mp4","mpeg","mpg","mts","pdf","pptm","pptx","potm","potx","ppsm","ppsx","psd","ts","vob","wmf","wmv","xesc","xlsm","xlsx"].concat(e._browserViewableImageExtensions)),e.VIEWPORT_PARAMETER_TOP="vt",e.VIEWPORT_PARAMETER_LEFT="vl",e.VIEWPORT_PARAMETER_WIDTH="vw",e.VIEWPORT_PARAMETER_HEIGHT="vh",e.CROPMODE_PARAMETER="cm",e.ORIGINAL_HEIGHT_PARAMETER="oh",e.ORIGINAL_WIDTH_PARAMETER="ow",e}(),P=function(){function e(){}return e.convertToImageUrl=function(e){var t={spResource:e.sourceUrl,fileType:M.getFileExtension(new p(e.sourceUrl)),width:e.width,height:e.height,callerId:"PublicApi",absoluteUrl:window.location.href};return A.getThumbnailUrl(t)},e}()},ut3N:function(e,t){e.exports=o}})});