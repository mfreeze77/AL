(window.webpackJsonp_974a7777_0990_4136_8fa6_95d80114c2e0_1_16_1=window.webpackJsonp_974a7777_0990_4136_8fa6_95d80114c2e0_1_16_1||[]).push([[3],{"3YRB":function(e,t,n){(function(t){self,e.exports=(()=>{var e={378:e=>{var t=1e3,n=60*t,a=60*n,i=24*a;function r(e){if(!((e=String(e)).length>100)){var r=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(r){var o=parseFloat(r[1]);switch((r[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*o;case"weeks":case"week":case"w":return 6048e5*o;case"days":case"day":case"d":return o*i;case"hours":case"hour":case"hrs":case"hr":case"h":return o*a;case"minutes":case"minute":case"mins":case"min":case"m":return o*n;case"seconds":case"second":case"secs":case"sec":case"s":return o*t;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return o;default:return}}}}function o(e){var r=Math.abs(e);return r>=i?Math.round(e/i)+"d":r>=a?Math.round(e/a)+"h":r>=n?Math.round(e/n)+"m":r>=t?Math.round(e/t)+"s":e+"ms"}function s(e){var r=Math.abs(e);return r>=i?c(e,r,i,"day"):r>=a?c(e,r,a,"hour"):r>=n?c(e,r,n,"minute"):r>=t?c(e,r,t,"second"):e+" ms"}function c(e,t,n,a){var i=t>=1.5*n;return Math.round(e/n)+" "+a+(i?"s":"")}e.exports=function(e,t){t=t||{};var n=typeof e;if("string"===n&&e.length>0)return r(e);if("number"===n&&isFinite(e))return t.long?s(e):o(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},22:(e,t,n)=>{var a=n(481),i=n(426),r=i;r.v1=a,r.v4=i,e.exports=r},725:e=>{for(var t=[],n=0;n<256;++n)t[n]=(n+256).toString(16).substr(1);e.exports=function(e,n){var a=n||0,i=t;return[i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],"-",i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]],i[e[a++]]].join("")}},157:e=>{var t="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(t){var n=new Uint8Array(16);e.exports=function(){return t(n),n}}else{var a=new Array(16);e.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}},481:(e,t,n)=>{var a,i,r=n(157),o=n(725),s=0,c=0;e.exports=function(e,t,n){var d=t&&n||0,l=t||[],u=(e=e||{}).node||a,f=void 0!==e.clockseq?e.clockseq:i;if(null==u||null==f){var p=r();null==u&&(u=a=[1|p[0],p[1],p[2],p[3],p[4],p[5]]),null==f&&(f=i=16383&(p[6]<<8|p[7]))}var m=void 0!==e.msecs?e.msecs:(new Date).getTime(),_=void 0!==e.nsecs?e.nsecs:c+1,h=m-s+(_-c)/1e4;if(h<0&&void 0===e.clockseq&&(f=f+1&16383),(h<0||m>s)&&void 0===e.nsecs&&(_=0),_>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");s=m,c=_,i=f;var b=(1e4*(268435455&(m+=122192928e5))+_)%4294967296;l[d++]=b>>>24&255,l[d++]=b>>>16&255,l[d++]=b>>>8&255,l[d++]=255&b;var g=m/4294967296*1e4&268435455;l[d++]=g>>>8&255,l[d++]=255&g,l[d++]=g>>>24&15|16,l[d++]=g>>>16&255,l[d++]=f>>>8|128,l[d++]=255&f;for(var v=0;v<6;++v)l[d+v]=u[v];return t||o(l)}},426:(e,t,n)=>{var a=n(157),i=n(725);e.exports=function(e,t,n){var r=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var o=(e=e||{}).random||(e.rng||a)();if(o[6]=15&o[6]|64,o[8]=63&o[8]|128,t)for(var s=0;s<16;++s)t[r+s]=o[s];return t||i(o)}},227:(e,n,a)=>{n.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+e.exports.humanize(this.diff),!this.useColors)return;const n="color: "+this.color;t.splice(1,0,n,"color: inherit");let a=0,i=0;t[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(a++,"%c"===e&&(i=a))}),t.splice(i,0,n)},n.save=function(e){try{e?n.storage.setItem("debug",e):n.storage.removeItem("debug")}catch(e){}},n.load=function(){let e;try{e=n.storage.getItem("debug")}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e},n.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},n.storage=function(){try{return localStorage}catch(e){}}(),n.destroy=(()=>{let e=!1;return()=>{e||(e=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}})(),n.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],n.log=console.debug||console.log||(()=>{}),e.exports=a(447)(n);const{formatters:i}=e.exports;i.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}},447:(e,t,n)=>{e.exports=function(e){function t(e){let n,i,r,o=null;function s(...e){if(!s.enabled)return;const a=s,i=Number(new Date),r=i-(n||i);a.diff=r,a.prev=n,a.curr=i,n=i,e[0]=t.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let o=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(n,i)=>{if("%%"===n)return"%";o++;const r=t.formatters[i];if("function"==typeof r){const t=e[o];n=r.call(a,t),e.splice(o,1),o--}return n}),t.formatArgs.call(a,e),(a.log||t.log).apply(a,e)}return s.namespace=e,s.useColors=t.useColors(),s.color=t.selectColor(e),s.extend=a,s.destroy=t.destroy,Object.defineProperty(s,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==o?o:(i!==t.namespaces&&(i=t.namespaces,r=t.enabled(e)),r),set:e=>{o=e}}),"function"==typeof t.init&&t.init(s),s}function a(e,n){const a=t(this.namespace+(void 0===n?":":n)+e);return a.log=this.log,a}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return t.debug=t,t.default=t,t.coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){const e=[...t.names.map(i),...t.skips.map(i).map(e=>"-"+e)].join(",");return t.enable(""),e},t.enable=function(e){let n;t.save(e),t.namespaces=e,t.names=[],t.skips=[];const a=("string"==typeof e?e:"").split(/[\s,]+/),i=a.length;for(n=0;n<i;n++)a[n]&&("-"===(e=a[n].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){if("*"===e[e.length-1])return!0;let n,a;for(n=0,a=t.skips.length;n<a;n++)if(t.skips[n].test(e))return!1;for(n=0,a=t.names.length;n<a;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(378),t.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(n=>{t[n]=e[n]}),t.names=[],t.skips=[],t.formatters={},t.selectColor=function(e){let n=0;for(let t=0;t<e.length;t++)n=(n<<5)-n+e.charCodeAt(t),n|=0;return t.colors[Math.abs(n)%t.colors.length]},t.enable(t.load()),t}}},n={};function a(t){var i=n[t];if(void 0!==i)return i.exports;var r=n[t]={exports:{}};return e[t](r,r.exports,a),r.exports}a.d=(e,t)=>{for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var i={};return(()=>{"use strict";a.r(i),a.d(i,{ActionObjectType:()=>t,ChannelType:()=>_,ChildAppWindow:()=>bt,DialogDimension:()=>f,ErrorCode:()=>r,FileOpenPreference:()=>e,FrameContexts:()=>d,HostClientType:()=>s,HostName:()=>c,NotificationTypes:()=>Ie,ParentAppWindow:()=>gt,SecondaryM365ContentIdName:()=>n,TaskModuleDimension:()=>h,TeamType:()=>l,UserSettingTypes:()=>Ce,UserTeamRole:()=>u,ViewerActionTypes:()=>xe,app:()=>N,appEntity:()=>mt,appInitialization:()=>st,appInstallDialog:()=>we,authentication:()=>P,barCode:()=>je,calendar:()=>Xe,call:()=>ot,chat:()=>Ve,conversations:()=>Oe,dialog:()=>F,enablePrintCapability:()=>yt,executeDeepLink:()=>Ft,files:()=>lt,geoLocation:()=>ze,getContext:()=>Dt,getMruTabInstances:()=>Tt,getTabInstances:()=>Pt,initialize:()=>vt,initializeWithFrameContext:()=>Rt,location:()=>Qe,logs:()=>De,mail:()=>Ze,media:()=>Be,meeting:()=>Ye,meetingRoom:()=>ut,menus:()=>H,monetization:()=>Je,navigateBack:()=>Vt,navigateCrossDomain:()=>jt,navigateToTab:()=>Bt,notifications:()=>ft,openFilePreview:()=>Re,pages:()=>B,people:()=>$e,print:()=>St,profile:()=>et,registerAppButtonClickHandler:()=>Ct,registerAppButtonHoverEnterHandler:()=>Ot,registerAppButtonHoverLeaveHandler:()=>wt,registerBackButtonHandler:()=>Et,registerBeforeUnloadHandler:()=>Lt,registerChangeSettingsHandler:()=>Mt,registerCustomHandler:()=>Fe,registerFocusEnterHandler:()=>kt,registerFullScreenHandler:()=>xt,registerOnLoadHandler:()=>At,registerOnThemeChangeHandler:()=>It,registerUserSettingsChangeHandler:()=>He,remoteCamera:()=>pt,returnFocus:()=>Nt,search:()=>nt,sendCustomEvent:()=>Ue,sendCustomMessage:()=>Te,setFrameContext:()=>Ht,settings:()=>ct,shareDeepLink:()=>Ut,sharing:()=>at,stageView:()=>it,tasks:()=>dt,teams:()=>_t,teamsCore:()=>R,uploadCustomApp:()=>Pe,version:()=>p,video:()=>tt,videoEx:()=>ht,webStorage:()=>rt});var e,t,n,r,o,s,c,d,l,u,f,p="2.4.1",m=function(){function e(){}return e.initializeCalled=!1,e.initializeCompleted=!1,e.additionalValidOrigins=[],e.isFramelessWindow=!1,e.printCapabilityEnabled=!1,e}();!function(e){e.Inline="inline",e.Desktop="desktop",e.Web="web"}(e||(e={})),function(e){e.M365Content="m365content"}(t||(t={})),function(e){e.DriveId="driveId",e.GroupId="groupId",e.SiteId="siteId",e.UserId="userId"}(n||(n={})),function(e){e[e.NOT_SUPPORTED_ON_PLATFORM=100]="NOT_SUPPORTED_ON_PLATFORM",e[e.INTERNAL_ERROR=500]="INTERNAL_ERROR",e[e.NOT_SUPPORTED_IN_CURRENT_CONTEXT=501]="NOT_SUPPORTED_IN_CURRENT_CONTEXT",e[e.PERMISSION_DENIED=1e3]="PERMISSION_DENIED",e[e.NETWORK_ERROR=2e3]="NETWORK_ERROR",e[e.NO_HW_SUPPORT=3e3]="NO_HW_SUPPORT",e[e.INVALID_ARGUMENTS=4e3]="INVALID_ARGUMENTS",e[e.UNAUTHORIZED_USER_OPERATION=5e3]="UNAUTHORIZED_USER_OPERATION",e[e.INSUFFICIENT_RESOURCES=6e3]="INSUFFICIENT_RESOURCES",e[e.THROTTLE=7e3]="THROTTLE",e[e.USER_ABORT=8e3]="USER_ABORT",e[e.OPERATION_TIMED_OUT=8001]="OPERATION_TIMED_OUT",e[e.OLD_PLATFORM=9e3]="OLD_PLATFORM",e[e.FILE_NOT_FOUND=404]="FILE_NOT_FOUND",e[e.SIZE_EXCEEDED=1e4]="SIZE_EXCEEDED"}(r||(r={})),function(e){e.GeoLocation="geolocation",e.Media="media"}(o||(o={})),function(e){e.desktop="desktop",e.web="web",e.android="android",e.ios="ios",e.ipados="ipados",e.rigel="rigel",e.surfaceHub="surfaceHub",e.teamsRoomsWindows="teamsRoomsWindows",e.teamsRoomsAndroid="teamsRoomsAndroid",e.teamsPhones="teamsPhones",e.teamsDisplays="teamsDisplays"}(s||(s={})),function(e){e.office="Office",e.outlook="Outlook",e.outlookWin32="OutlookWin32",e.orange="Orange",e.teams="Teams"}(c||(c={})),function(e){e.settings="settings",e.content="content",e.authentication="authentication",e.remove="remove",e.task="task",e.sidePanel="sidePanel",e.stage="stage",e.meetingStage="meetingStage"}(d||(d={})),function(e){e[e.Standard=0]="Standard",e[e.Edu=1]="Edu",e[e.Class=2]="Class",e[e.Plc=3]="Plc",e[e.Staff=4]="Staff"}(l||(l={})),function(e){e[e.Admin=0]="Admin",e[e.User=1]="User",e[e.Guest=2]="Guest"}(u||(u={})),function(e){e.Large="large",e.Medium="medium",e.Small="small"}(f||(f={}));var _,h=f;!function(e){e.Regular="Regular",e.Private="Private",e.Shared="Shared"}(_||(_={}));var b={errorCode:r.NOT_SUPPORTED_ON_PLATFORM},g="2.0.1",v="2.0.3",y="1.9.0",S="1.8.0",D=["teams.microsoft.com","teams.microsoft.us","gov.teams.microsoft.us","dod.teams.microsoft.us","int.teams.microsoft.com","teams.live.com","devspaces.skype.com","ssauth.skype.com","local.teams.live.com","local.teams.live.com:8080","local.teams.office.com","local.teams.office.com:8080","msft.spoppe.com","*.sharepoint.com","*.sharepoint-df.com","*.sharepointonline.com","outlook.office.com","outlook-sdf.office.com","outlook.office365.com","outlook-sdf.office365.com","*.teams.microsoft.com","www.office.com","word.office.com","excel.office.com","powerpoint.office.com","www.officeppe.com","*.www.office.com"],I=/^https:\/\//,x=a(22);function C(e,t){if("*."===e.substring(0,2)){var n=e.substring(1);if(t.length>n.length&&t.split(".").length===n.split(".").length&&t.substring(t.length-n.length)===n)return!0}else if(e===t)return!0;return!1}function O(e){return function(t,n){if(!t)throw new Error(e||n)}}function w(e,t){if("string"!=typeof e||"string"!=typeof t)return NaN;var n=e.split("."),a=t.split(".");function i(e){return/^\d+$/.test(e)}if(!n.every(i)||!a.every(i))return NaN;for(;n.length<a.length;)n.push("0");for(;a.length<n.length;)a.push("0");for(var r=0;r<n.length;++r)if(Number(n[r])!=Number(a[r]))return Number(n[r])>Number(a[r])?1:-1;return 0}function E(e){return Object.keys(e).forEach(function(t){"object"==typeof e[t]&&E(e[t])}),Object.freeze(e)}function A(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e.apply(void 0,n);return i.then(function(){t&&t(null)}).catch(function(e){t&&t(e)}),i}function L(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(!m.initializeCalled)throw new Error("The library has not yet been initialized");if(m.frameContext&&e&&e.length>0){for(var n=!1,a=0;a<e.length;a++)if(e[a]===m.frameContext){n=!0;break}if(!n)throw new Error("This call is only allowed in following contexts: "+JSON.stringify(e)+'. Current context: "'+m.frameContext+'".')}}function k(e){void 0===e&&(e=g);var t=w(m.clientSupportedSDKVersion,e);return!isNaN(t)&&t>=0}function M(e){if(void 0===e&&(e=g),m.hostClientType!=s.android&&m.hostClientType!=s.ios)throw{errorCode:r.NOT_SUPPORTED_ON_PLATFORM};if(!k(e))throw{errorCode:r.OLD_PLATFORM}}var P,T=(0,a(227).debug)("teamsJs");function U(e){return T.extend(e)}!function(e){var t,n,a;function i(e){return new Promise(function(n,a){if(m.hostClientType===s.desktop||m.hostClientType===s.android||m.hostClientType===s.ios||m.hostClientType===s.rigel||m.hostClientType===s.teamsRoomsWindows||m.hostClientType===s.teamsRoomsAndroid||m.hostClientType===s.teamsPhones||m.hostClientType===s.teamsDisplays){var i=document.createElement("a");i.href=e.url,n(me("authentication.authenticate",[i.href,e.width,e.height,e.isExternal]).then(function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)}))}else t={success:n,fail:a},function(e){r();var t=e.width||600,n=e.height||400;t=Math.min(t,ce.currentWindow.outerWidth-400),n=Math.min(n,ce.currentWindow.outerHeight-200);var a=document.createElement("a");a.href=e.url.replace("{oauthRedirectMethod}","web");var i=void 0!==ce.currentWindow.screenLeft?ce.currentWindow.screenLeft:ce.currentWindow.screenX,o=void 0!==ce.currentWindow.screenTop?ce.currentWindow.screenTop:ce.currentWindow.screenY;i+=ce.currentWindow.outerWidth/2-t/2,o+=ce.currentWindow.outerHeight/2-n/2,ce.childWindow=ce.currentWindow.open(a.href,"_blank","toolbar=no, location=yes, status=no, menubar=no, scrollbars=yes, top="+o+", left="+i+", width="+t+", height="+n),ce.childWindow?c():u("FailedToOpenWindow")}(e)})}function r(){o();try{ce.childWindow&&ce.childWindow.close()}finally{ce.childWindow=null,ce.childOrigin=null}}function o(){n&&(clearInterval(n),n=0),te("initialize"),te("navigateCrossDomain")}function c(){o(),n=ce.currentWindow.setInterval(function(){if(!ce.childWindow||ce.childWindow.closed)u("CancelledByUser");else{var e=ce.childOrigin;try{ce.childOrigin="*",Me("ping")}finally{ce.childOrigin=e}}},100),ee("initialize",function(){return[d.authentication,m.hostClientType]}),ee("navigateCrossDomain",function(){return!1})}function l(e){try{t&&t.success(e)}finally{t=null,r()}}function u(e){try{t&&t.fail(new Error(e))}finally{t=null,r()}}function f(e,t,n){if(e){var a=document.createElement("a");a.href=decodeURIComponent(e),a.host&&a.host!==window.location.host&&"outlook.office.com"===a.host&&a.search.indexOf("client_type=Win32_Outlook")>-1&&(t&&"result"===t&&(n&&(a.href=p(a.href,"result",n)),ce.currentWindow.location.assign(p(a.href,"authSuccess",""))),t&&"reason"===t&&(n&&(a.href=p(a.href,"reason",n)),ce.currentWindow.location.assign(p(a.href,"authFailure",""))))}}function p(e,t,n){var a=e.indexOf("#"),i=-1===a?"#":e.substr(a);return i=i+"&"+t+(""!==n?"="+n:""),(e=-1===a?e:e.substr(0,a))+i}e.initialize=function(){ee("authentication.authenticate.success",l,!1),ee("authentication.authenticate.failure",u,!1)},e.registerAuthenticationHandlers=function(e){a=e},e.authenticate=function(e){var t=void 0!==e,n=t?e:a;if(!n)throw new Error("No parameters are provided for authentication");return L(d.content,d.sidePanel,d.settings,d.remove,d.task,d.stage,d.meetingStage),i(n).then(function(e){try{return n&&n.successCallback?(n.successCallback(e),""):e}finally{t||(a=null)}}).catch(function(e){try{if(n&&n.failureCallback)return n.failureCallback(e.message),"";throw e}finally{t||(a=null)}})},e.getAuthToken=function(e){return L(),function(e){return new Promise(function(t){t(me("authentication.getAuthToken",[null==e?void 0:e.resources,null==e?void 0:e.claims,null==e?void 0:e.silent]))}).then(function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)})}(e).then(function(t){return e&&e.successCallback?(e.successCallback(t),""):t}).catch(function(t){if(e&&e.failureCallback)return e.failureCallback(t.message),"";throw t})},e.getUser=function(e){return L(),new Promise(function(e){e(me("authentication.getUser"))}).then(function(e){var t=e[0],n=e[1];if(t)return n;throw new Error(n)}).then(function(t){return e&&e.successCallback?(e.successCallback(t),null):t}).catch(function(t){if(e&&e.failureCallback)return e.failureCallback(t.message),null;throw t})},e.notifySuccess=function(e,t){f(t,"result",e),L(d.authentication),_e("authentication.authenticate.success",[e]),Le(ce.parentWindow,function(){return setTimeout(function(){return ce.currentWindow.close()},200)})},e.notifyFailure=function(e,t){f(t,"reason",e),L(d.authentication),_e("authentication.authenticate.failure",[e]),Le(ce.parentWindow,function(){return setTimeout(function(){return ce.currentWindow.close()},200)})}}(P||(P={}));var F,H,R,N,B,j=function(){return j=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},j.apply(this,arguments)},V=U("runtime"),z={apiVersion:1,supports:{appInstallDialog:void 0,barCode:void 0,calendar:void 0,call:void 0,chat:void 0,webStorage:void 0,conversations:void 0,dialog:{bot:void 0,update:void 0},geoLocation:{map:void 0},location:void 0,logs:void 0,mail:void 0,meetingRoom:void 0,menus:void 0,monetization:void 0,notifications:void 0,pages:{appButton:void 0,backStack:void 0,config:void 0,currentApp:void 0,fullTrust:void 0,tabs:void 0},people:void 0,permissions:void 0,profile:void 0,remoteCamera:void 0,search:void 0,sharing:void 0,stageView:void 0,teams:{fullTrust:{joinedTeams:void 0}},teamsCore:void 0,video:void 0}},G={appInstallDialog:{},appEntity:{},call:{},chat:{},conversations:{},dialog:{bot:{},update:{}},logs:{},meetingRoom:{},menus:{},monetization:{},notifications:{},pages:{appButton:{},tabs:{},config:{},backStack:{},fullTrust:{}},remoteCamera:{},sharing:{},stageView:{},teams:{fullTrust:{}},teamsCore:{},video:{}},K=[s.desktop,s.web,s.android,s.ios,s.rigel,s.surfaceHub,s.teamsRoomsWindows,s.teamsRoomsAndroid,s.teamsPhones,s.teamsDisplays],W={"1.9.0":[{capability:{location:{}},hostClientTypes:K}],"2.0.0":[{capability:{people:{}},hostClientTypes:K}],"2.0.1":[{capability:{teams:{fullTrust:{joinedTeams:{}}}},hostClientTypes:[s.android,s.desktop,s.ios,s.teamsRoomsAndroid,s.teamsPhones,s.teamsDisplays,s.web]},{capability:{webStorage:{}},hostClientTypes:[s.desktop]}],"2.0.5":[{capability:{webStorage:{}},hostClientTypes:[s.android,s.desktop,s.ios]}]},q=V.extend("generateBackCompatRuntimeConfig"),Q=V.extend("applyRuntimeConfig");function Y(e){Q("Applying runtime %o",e),z=E(e)}!function(e){var t=[];function n(e){m.frameContext&&(m.frameContext===d.task?t.push(e):te("messageForChild"))}function a(){return!!z.supports.dialog}function i(e){return{url:e.url,height:e.size?e.size.height:f.Small,width:e.size?e.size.width:f.Small,title:e.title,fallbackUrl:e.fallbackUrl}}function r(e){return{url:e.url,height:e.size?e.size.height:f.Small,width:e.size?e.size.width:f.Small,title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}e.initialize=function(){ee("messageForChild",n,!1)},e.open=function(e,t,n){if(L(d.content,d.sidePanel,d.meetingStage),!a())throw b;n&&ee("messageForParent",n),_e("tasks.startTask",[i(e)],function(e,n){null==t||t({err:e,result:n}),te("messageForParent")})},e.submit=function(e,t){if(L(d.content,d.sidePanel,d.task,d.meetingStage),!a())throw b;_e("tasks.completeTask",[e,t?Array.isArray(t)?t:[t]:[]])},e.sendMessageToParentFromDialog=function(e){if(L(d.task),!a())throw b;_e("messageForParent",[e])},e.sendMessageToDialog=function(e){if(L(d.content,d.sidePanel,d.meetingStage),!a())throw b;_e("messageForChild",[e])},e.registerOnMessageFromParent=function(e){if(L(d.task),!a())throw b;for(te("messageForChild"),ee("messageForChild",e),t.reverse();t.length>0;)e(t.pop())},e.isSupported=a,function(e){function t(){return!!z.supports.dialog&&!!z.supports.dialog.update}e.resize=function(e){if(L(d.content,d.sidePanel,d.task,d.meetingStage),!t())throw b;_e("tasks.updateTask",[e])},e.isSupported=t}(e.update||(e.update={})),function(e){function t(){return!!z.supports.dialog&&!!z.supports.dialog.bot}e.open=function(e,n,a){if(L(d.content,d.sidePanel,d.meetingStage),!t())throw b;a&&ee("messageForParent",a),_e("tasks.startTask",[r(e)],function(e,t){null==n||n({err:e,result:t}),te("messageForParent")})},e.isSupported=t}(e.bot||(e.bot={})),e.getDialogInfoFromUrlDialogInfo=i,e.getDialogInfoFromBotUrlDialogInfo=r}(F||(F={})),function(e){var t,n,a;function i(e){a&&a(e)||(L(),_e("viewConfigItemPress",[e]))}function r(e){t&&t(e)||(L(),_e("handleNavBarMenuItemPress",[e]))}function o(e){n&&n(e)||(L(),_e("handleActionMenuItemPress",[e]))}function s(){return!!z.supports.menus}!function(e){e[e.ifRoom=0]="ifRoom",e[e.overflowOnly=1]="overflowOnly"}(e.DisplayMode||(e.DisplayMode={})),e.MenuItem=function(){this.enabled=!0,this.selected=!1},function(e){e.dropDown="dropDown",e.popOver="popOver"}(e.MenuListType||(e.MenuListType={})),e.initialize=function(){ee("navBarMenuItemPress",r,!1),ee("actionMenuItemPress",o,!1),ee("setModuleView",i,!1)},e.setUpViews=function(e,t){if(L(),!s())throw b;a=t,_e("setUpViews",[e])},e.setNavBarMenu=function(e,n){if(L(),!s())throw b;t=n,_e("setNavBarMenu",[e])},e.showActionMenu=function(e,t){if(L(),!s())throw b;n=t,_e("showActionMenu",[e])},e.isSupported=s}(H||(H={})),function(e){function t(){window.print()}function n(e,t){L(),t&&t(),function(e){X.loadHandler=e,e&&_e("registerHandler",["load"])}(e)}function a(e,t){L(),t&&t(),function(e){X.beforeUnloadHandler=e,e&&_e("registerHandler",["beforeUnload"])}(e)}function i(){return!!z.supports.teamsCore}e.enablePrintCapability=function(){if(!m.printCapabilityEnabled){if(L(),!i())throw b;m.printCapabilityEnabled=!0,document.addEventListener("keydown",function(e){(e.ctrlKey||e.metaKey)&&80===e.keyCode&&(t(),e.cancelBubble=!0,e.preventDefault(),e.stopImmediatePropagation())})}},e.print=t,e.registerOnLoadHandler=function(e){n(e,function(){if(!i())throw b})},e.registerOnLoadHandlerHelper=n,e.registerBeforeUnloadHandler=function(e){a(e,function(){if(!i())throw b})},e.registerBeforeUnloadHandlerHelper=a,e.isSupported=i}(R||(R={})),function(e){var t=U("app");e.Messages={AppLoaded:"appInitialization.appLoaded",Success:"appInitialization.success",Failure:"appInitialization.failure",ExpectedFailure:"appInitialization.expectedFailure"},function(e){e.AuthFailed="AuthFailed",e.Timeout="Timeout",e.Other="Other"}(e.FailedReason||(e.FailedReason={})),function(e){e.PermissionError="PermissionError",e.NotFound="NotFound",e.Throttling="Throttling",e.Offline="Offline",e.Other="Other"}(e.ExpectedFailureReason||(e.ExpectedFailureReason={})),e.isInitialized=function(){return m.initializeCalled},e.getFrameContext=function(){return m.frameContext},e.initialize=function(e){return function(e,t,n){return new Promise(function(t,a){var i=setTimeout(a,5e3,n);e().then(function(e){clearTimeout(i),t(e)}).catch(function(e){clearTimeout(i),a(e)})})}(function(){return function(e){return new Promise(function(t){m.initializeCalled||(m.initializeCalled=!0,X.handlers.themeChange=ae,X.handlers.load=ie,X.handlers.beforeUnload=re,B.backStack._initialize(),m.initializePromise=function(e){if(de.messageListener=function(e){return function(e){if(e&&e.data&&"object"==typeof e.data){var t=e.source||e.originalEvent&&e.originalEvent.source,n=e.origin||e.originalEvent&&e.originalEvent.origin;(function(e,t){return(!ce.currentWindow||e!==ce.currentWindow)&&(!!(ce.currentWindow&&ce.currentWindow.location&&t&&t===ce.currentWindow.location.origin)||function(e){if("https:"!==e.protocol)return!1;var t=e.host;if(D.some(function(e){return C(e,t)}))return!0;for(var n=0,a=m.additionalValidOrigins;n<a.length;n++){var i=a[n];if(C("https://"===i.substring(0,8)?i.substring(8):i,t))return!0}return!1}(new URL(t)))})(t,n)&&(function(e,t){m.isFramelessWindow||ce.parentWindow&&!ce.parentWindow.closed&&e!==ce.parentWindow?ce.childWindow&&!ce.childWindow.closed&&e!==ce.childWindow||(ce.childWindow=e,ce.childOrigin=t):(ce.parentWindow=e,ce.parentOrigin=t),ce.parentWindow&&ce.parentWindow.closed&&(ce.parentWindow=null,ce.parentOrigin=null),ce.childWindow&&ce.childWindow.closed&&(ce.childWindow=null,ce.childOrigin=null),Ae(ce.parentWindow),Ae(ce.childWindow)}(t,n),t===ce.parentWindow?ve(e):t===ce.childWindow&&function(e){if("id"in e.data&&"func"in e.data){var t=e.data,n=$(t.func,t.args),a=n[0],i=n[1];a&&void 0!==i?ke(t.id,Array.isArray(i)?i:[i]):_e(t.func,t.args,function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(ce.childWindow){var a=e.pop();ke(t.id,e,a)}})}}(e))}}(e)},ce.currentWindow=ce.currentWindow||window,ce.parentWindow=ce.currentWindow.parent!==ce.currentWindow.self?ce.currentWindow.parent:ce.currentWindow.opener,(ce.parentWindow||e)&&ce.currentWindow.addEventListener("message",de.messageListener,!1),!ce.parentWindow){var t=ce.currentWindow;if(!t.nativeInterface)return Promise.reject(new Error("Initialization Failed. No Parent window found."));m.isFramelessWindow=!0,t.onNativeMessage=ve}try{return ce.parentOrigin="*",me("initialize",[p]).then(function(e){return{context:e[0],clientType:e[1],runtimeConfig:e[2],clientSupportedSDKVersion:e[3]}})}finally{ce.parentOrigin=null}}(e).then(function(e){var t=e.context,a=e.clientType,i=e.runtimeConfig,r=e.clientSupportedSDKVersion,o=void 0===r?g:r;m.frameContext=t,m.hostClientType=a,m.clientSupportedSDKVersion=o;try{n("Parsing %s",i);var s=JSON.parse(i);if(n("Checking if %o is a valid runtime object",null!=s?s:"null"),!s||!s.apiVersion)throw new Error("Received runtime config is invalid");i&&Y(s)}catch(e){if(!(e instanceof SyntaxError))throw e;try{if(n("Attempting to parse %s as an SDK version",i),isNaN(w(i,g))||(m.clientSupportedSDKVersion=i),s=JSON.parse(o),n("givenRuntimeConfig parsed to %o",null!=s?s:"null"),!s)throw new Error("givenRuntimeConfig string was successfully parsed. However, it parsed to value of null");Y(s)}catch(e){if(!(e instanceof SyntaxError))throw e;Y(function(e){q("generating back compat runtime config for %s",e);var t=j({},G);q("Supported capabilities in config before updating based on highestSupportedVersion: %o",t),Object.keys(W).forEach(function(n){w(e,n)>=0&&W[n].forEach(function(e){e.hostClientTypes.includes(m.hostClientType)&&(t=j(j({},t),e.capability))})});var n={apiVersion:1,isLegacyTeams:!0,supports:t};return q("Runtime config after updating based on highestSupportedVersion: %o",n),n}(m.clientSupportedSDKVersion))}}m.initializeCompleted=!0}),P.initialize(),H.initialize(),B.config.initialize(),F.initialize()),Array.isArray(e)&&function(e){var t=m.additionalValidOrigins.concat(e.filter(function(e){return"string"==typeof e&&I.test(e)})),n={};t=t.filter(function(e){return!n[e]&&(n[e]=!0,!0)}),m.additionalValidOrigins=t}(e),t(m.initializePromise)})}(e)},0,new Error("SDK initialization timed out."))};var n=t.extend("initializeHelper");function a(e){L(),function(e){X.themeChangeHandler=e,e&&_e("registerHandler",["themeChange"])}(e)}e._initialize=function(e){ce.currentWindow=e},e._uninitialize=function(){m.initializeCalled&&(m.frameContext&&(a(null),B.backStack.registerBackButtonHandler(null),B.registerFullScreenHandler(null),R.registerBeforeUnloadHandler(null),R.registerOnLoadHandler(null),De.registerGetLogHandler(null)),m.frameContext===d.settings&&B.config.registerOnSaveHandler(null),m.frameContext===d.remove&&B.config.registerOnRemoveHandler(null),m.initializeCalled=!1,m.initializeCompleted=!1,m.initializePromise=null,m.additionalValidOrigins=[],m.frameContext=null,m.hostClientType=null,m.isFramelessWindow=!1,ce.currentWindow.removeEventListener("message",de.messageListener,!1),ce.parentWindow=null,ce.parentOrigin=null,ce.childWindow=null,ce.childOrigin=null,de.parentMessageQueue=[],de.childMessageQueue=[],de.nextMessageId=0,de.callbacks={})},e.getContext=function(){return new Promise(function(e){L(),e(le("getContext"))}).then(function(e){return function(e){return{actionInfo:e.actionInfo,app:{locale:e.locale,sessionId:e.appSessionId?e.appSessionId:"",theme:e.theme?e.theme:"default",iconPositionVertical:e.appIconPosition,osLocaleInfo:e.osLocaleInfo,parentMessageId:e.parentMessageId,userClickTime:e.userClickTime,userFileOpenPreference:e.userFileOpenPreference,host:{name:e.hostName?e.hostName:c.teams,clientType:e.hostClientType?e.hostClientType:s.web,sessionId:e.sessionId?e.sessionId:"",ringId:e.ringId},appLaunchId:e.appLaunchId},page:{id:e.entityId,frameContext:e.frameContext?e.frameContext:m.frameContext,subPageId:e.subEntityId,isFullScreen:e.isFullScreen,isMultiWindow:e.isMultiWindow,sourceOrigin:e.sourceOrigin},user:{id:e.userObjectId,displayName:e.userDisplayName,isCallingAllowed:e.isCallingAllowed,isPSTNCallingAllowed:e.isPSTNCallingAllowed,licenseType:e.userLicenseType,loginHint:e.loginHint,userPrincipalName:e.userPrincipalName,tenant:e.tid?{id:e.tid,teamsSku:e.tenantSKU}:void 0},channel:e.channelId?{id:e.channelId,displayName:e.channelName,relativeUrl:e.channelRelativeUrl,membershipType:e.channelType,defaultOneNoteSectionId:e.defaultOneNoteSectionId,ownerGroupId:e.hostTeamGroupId,ownerTenantId:e.hostTeamTenantId}:void 0,chat:e.chatId?{id:e.chatId}:void 0,meeting:e.meetingId?{id:e.meetingId}:void 0,sharepoint:e.sharepoint,team:e.teamId?{internalId:e.teamId,displayName:e.teamName,type:e.teamType,groupId:e.groupId,templateId:e.teamTemplateId,isArchived:e.isTeamArchived,userRole:e.userTeamRole}:void 0,sharePointSite:e.teamSiteUrl||e.teamSiteDomain||e.teamSitePath||e.mySitePath||e.mySiteDomain?{teamSiteUrl:e.teamSiteUrl,teamSiteDomain:e.teamSiteDomain,teamSitePath:e.teamSitePath,teamSiteId:e.teamSiteId,mySitePath:e.mySitePath,mySiteDomain:e.mySiteDomain}:void 0}}(e)})},e.notifyAppLoaded=function(){L(),_e(e.Messages.AppLoaded,[p])},e.notifySuccess=function(){L(),_e(e.Messages.Success,[p])},e.notifyFailure=function(t){L(),_e(e.Messages.Failure,[t.reason,t.message])},e.notifyExpectedFailure=function(t){L(),_e(e.Messages.ExpectedFailure,[t.reason,t.message])},e.registerOnThemeChangeHandler=a,e.openLink=function(e){return new Promise(function(t){L(d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),t(ue("executeDeepLink",e))})}}(N||(N={})),function(e){function t(e){if(L(d.content),!n())throw b;_e("setFrameContext",[e])}function n(){return!!z.supports.pages}e.returnFocus=function(e){if(L(),!n())throw b;_e("returnFocus",[e])},e.registerFocusEnterHandler=function(e){ne("focusEnter",e,[],function(){if(!n())throw b})},e.setCurrentFrame=t,e.initializeWithFrameContext=function(e,n,a){N.initialize(a).then(function(){return n&&n()}),t(e)},e.getConfig=function(){return new Promise(function(e){if(L(d.content,d.settings,d.remove,d.sidePanel),!n())throw b;e(le("settings.getSettings"))})},e.navigateCrossDomain=function(e){return new Promise(function(t){if(L(d.content,d.sidePanel,d.settings,d.remove,d.task,d.stage,d.meetingStage),!n())throw b;t(fe("navigateCrossDomain","Cross-origin navigation is only supported for URLs matching the pattern registered in the manifest.",e))})},e.navigateToApp=function(e){return new Promise(function(t){if(L(d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),!n())throw b;z.isLegacyTeams?t(ue("executeDeepLink",function(e){var t=new URL("https://teams.microsoft.com/l/entity/"+encodeURIComponent(e.appId)+"/"+encodeURIComponent(e.pageId));return e.webUrl&&t.searchParams.append("webUrl",e.webUrl),(e.channelId||e.subPageId)&&t.searchParams.append("context",JSON.stringify({channelId:e.channelId,subEntityId:e.subPageId})),t.toString()}(e))):t(ue("pages.navigateToApp",e))})},e.shareDeepLink=function(e){if(L(d.content,d.sidePanel,d.meetingStage),!n())throw b;_e("shareDeepLink",[e.subPageId,e.subPageLabel,e.subPageWebUrl])},e.registerFullScreenHandler=function(e){ne("fullScreenChange",e,[],function(){if(!n())throw b})},e.isSupported=n,function(e){function t(){return!!z.supports.pages&&!!z.supports.pages.tabs}e.navigateToTab=function(e){return new Promise(function(n){if(L(),!t())throw b;n(fe("navigateToTab","Invalid internalTabInstanceId and/or channelId were/was provided",e))})},e.getTabInstances=function(e){return new Promise(function(n){if(L(),!t())throw b;n(le("getTabInstances",e))})},e.getMruTabInstances=function(e){return new Promise(function(n){if(L(),!t())throw b;n(le("getMruTabInstances",e))})},e.isSupported=t}(e.tabs||(e.tabs={})),function(e){var t,n;function a(e,n){L(d.settings),n&&n(),t=e,e&&_e("registerHandler",["save"])}function i(e,t){L(d.remove,d.settings),t&&t(),n=e,e&&_e("registerHandler",["remove"])}function r(e){var n=new o(e);t?t(n):ce.childWindow?Me("settings.save",[e]):n.notifySuccess()}e.initialize=function(){ee("settings.save",r,!1),ee("settings.remove",s,!1)},e.setValidityState=function(e){if(L(d.settings,d.remove),!l())throw b;_e("settings.setValidityState",[e])},e.setConfig=function(e){return new Promise(function(t){if(L(d.content,d.settings,d.sidePanel),!l())throw b;t(ue("settings.setSettings",e))})},e.registerOnSaveHandler=function(e){a(e,function(){if(!l())throw b})},e.registerOnSaveHandlerHelper=a,e.registerOnRemoveHandler=function(e){i(e,function(){if(!l())throw b})},e.registerOnRemoveHandlerHelper=i,e.registerChangeConfigHandler=function(e){ne("changeSettings",e,[d.content],function(){if(!l())throw b})};var o=function(){function e(e){this.notified=!1,this.result=e||{}}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),_e("settings.save.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),_e("settings.save.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The SaveEvent may only notify success or failure once.")},e}();function s(){var e=new c;n?n(e):ce.childWindow?Me("settings.remove",[]):e.notifySuccess()}var c=function(){function e(){this.notified=!1}return e.prototype.notifySuccess=function(){this.ensureNotNotified(),_e("settings.remove.success"),this.notified=!0},e.prototype.notifyFailure=function(e){this.ensureNotNotified(),_e("settings.remove.failure",[e]),this.notified=!0},e.prototype.ensureNotNotified=function(){if(this.notified)throw new Error("The removeEvent may only notify success or failure once.")},e}();function l(){return!!z.supports.pages&&!!z.supports.pages.config}e.isSupported=l}(e.config||(e.config={})),function(e){var t;function n(){return new Promise(function(e){if(L(),!r())throw b;e(fe("navigateBack","Back navigation is not supported in the current client or context."))})}function a(e,n){L(),n&&n(),t=e,e&&_e("registerHandler",["backButton"])}function i(){t&&t()||(ce.childWindow?Me("backButtonPress",[]):n())}function r(){return!!z.supports.pages&&!!z.supports.pages.backStack}e._initialize=function(){ee("backButtonPress",i,!1)},e.navigateBack=n,e.registerBackButtonHandler=function(e){a(e,function(){if(!r())throw b})},e.registerBackButtonHandlerHelper=a,e.isSupported=r}(e.backStack||(e.backStack={})),function(e){function t(){return!!z.supports.pages&&!!z.supports.pages.fullTrust}e.enterFullscreen=function(){if(L(d.content),!t())throw b;_e("enterFullscreen",[])},e.exitFullscreen=function(){if(L(d.content),!t())throw b;_e("exitFullscreen",[])},e.isSupported=t}(e.fullTrust||(e.fullTrust={})),function(e){function t(){return!!z.supports.pages&&!!z.supports.pages.appButton}e.onClick=function(e){ne("appButtonClick",e,[d.content],function(){if(!t())throw b})},e.onHoverEnter=function(e){ne("appButtonHoverEnter",e,[d.content],function(){if(!t())throw b})},e.onHoverLeave=function(e){ne("appButtonHoverLeave",e,[d.content],function(){if(!t())throw b})},e.isSupported=t}(e.appButton||(e.appButton={})),function(e){function t(){return!!z.supports.pages&&!!z.supports.pages.currentApp}e.navigateTo=function(e){return new Promise(function(n){if(L(d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),!t())throw b;n(pe("pages.currentApp.navigateTo",e))})},e.navigateToDefaultPage=function(){return new Promise(function(e){if(L(d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),!t())throw b;e(pe("pages.currentApp.navigateToDefaultPage"))})},e.isSupported=t}(e.currentApp||(e.currentApp={}))}(B||(B={}));var J=U("handlers"),X=function(){function e(){}return e.handlers={},e}(),Z=J.extend("callHandler");function $(e,t){var n=X.handlers[e];return n?(Z("Invoking the registered handler for message %s with arguments %o",e,t),[!0,n.apply(this,t)]):ce.childWindow?(Me(e,[t]),[!1,void 0]):(Z("Handler for action message %s not found.",e),[!1,void 0])}function ee(e,t,n,a){void 0===n&&(n=!0),void 0===a&&(a=[]),t?(X.handlers[e]=t,n&&_e("registerHandler",function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))}([e],a,!0))):delete X.handlers[e]}function te(e){delete X.handlers[e]}function ne(e,t,n,a){L.apply(void 0,n),a&&a(),ee(e,t)}function ae(e){X.themeChangeHandler&&X.themeChangeHandler(e),ce.childWindow&&Me("themeChange",[e])}function ie(e){X.loadHandler&&X.loadHandler(e),ce.childWindow&&Me("load",[e])}function re(){var e=function(){_e("readyToUnload",[])};X.beforeUnloadHandler&&X.beforeUnloadHandler(e)||(ce.childWindow?Me("beforeUnload"):e())}var oe=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},se=U("communication"),ce=function(){},de=function(){function e(){}return e.parentMessageQueue=[],e.childMessageQueue=[],e.nextMessageId=0,e.callbacks={},e.promiseCallbacks={},e}();function le(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return me(e,t).then(function(e){return e[0]})}function ue(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return me(e,t).then(function(e){var t=e[0],n=e[1];if(!t)throw new Error(n)})}function fe(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];return me(e,n).then(function(e){var n=e[0],a=e[1];if(!n)throw new Error(a||t)})}function pe(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return me(e,t).then(function(e){var t=e[0],n=e[1];if(t)throw t;return n})}function me(e,t){return void 0===t&&(t=void 0),new Promise(function(n){n(function(e){return new Promise(function(t){de.promiseCallbacks[e]=t})}(be(e,t).id))})}function _e(e,t,n){var a;t instanceof Function?n=t:t instanceof Array&&(a=t);var i=be(e,a);n&&(de.callbacks[i.id]=n)}var he=se.extend("sendMessageToParentHelper");function be(e,t){var n=he,a=ce.parentWindow,i=function(e,t){return{id:de.nextMessageId++,func:e,timestamp:Date.now(),args:t||[]}}(e,t);if(n("Message %i information: %o",i.id,{actionName:e,args:t}),m.isFramelessWindow)ce.currentWindow&&ce.currentWindow.nativeInterface&&(n("Sending message %i to parent via framelessPostMessage interface",i.id),ce.currentWindow.nativeInterface.framelessPostMessage(JSON.stringify(i)));else{var r=Se(a);a&&r?(n("Sending message %i to parent via postMessage",i.id),a.postMessage(i,r)):(n("Adding message %i to parent message queue",i.id),ye(a).push(i))}return i}var ge=se.extend("handleParentMessage");function ve(e){var t=ge;if("id"in e.data&&"number"==typeof e.data.id){var n=e.data,a=de.callbacks[n.id];t("Received a response from parent for message %i",n.id),a&&(t("Invoking the registered callback for message %i with arguments %o",n.id,n.args),a.apply(null,oe(oe([],n.args,!0),[n.isPartialResponse],!1)),function(e){return!0===e.data.isPartialResponse}(e)||(t("Removing registered callback for message %i",n.id),delete de.callbacks[n.id]));var i=de.promiseCallbacks[n.id];i&&(t("Invoking the registered promise callback for message %i with arguments %o",n.id,n.args),i(n.args),t("Removing registered promise callback for message %i",n.id),delete de.promiseCallbacks[n.id])}else"func"in e.data&&"string"==typeof e.data.func?(t("Received an action message %s from parent",(n=e.data).func),$(n.func,n.args)):t("Received an unknown message: %O",e)}function ye(e){return e===ce.parentWindow?de.parentMessageQueue:e===ce.childWindow?de.childMessageQueue:[]}function Se(e){return e===ce.parentWindow?ce.parentOrigin:e===ce.childWindow?ce.childOrigin:null}var De,Ie,xe,Ce,Oe,we,Ee=se.extend("flushMessageQueue");function Ae(e){for(var t=Se(e),n=ye(e),a=e==ce.parentWindow?"parent":"child";e&&t&&n.length>0;){var i=n.shift();Ee("Flushing message %i from "+a+" message queue via postMessage.",i.id),e.postMessage(i,t)}}function Le(e,t){var n=ce.currentWindow.setInterval(function(){0===ye(e).length&&(clearInterval(n),t())},100)}function ke(e,t,n){var a=ce.childWindow,i=function(e,t,n){return{id:e,args:t||[],isPartialResponse:n}}(e,t,n),r=Se(a);a&&r&&a.postMessage(i,r)}function Me(e,t){var n=ce.childWindow,a=function(e,t){return{func:e,args:t||[]}}(e,t),i=Se(n);n&&i?n.postMessage(a,i):ye(n).push(a)}function Pe(e,t){L(),_e("uploadCustomApp",[e],t||O())}function Te(e,t,n){L(),_e(e,t,n)}function Ue(e,t){if(L(),!ce.childWindow)throw new Error("The child window has not yet been initialized or is not present");Me(e,t)}function Fe(e,t){var n=this;L(),ee(e,function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return t.apply(n,e)})}function He(e,t){L(),ee("userSettingsChange",t,!0,[e])}function Re(e){L(d.content,d.task),_e("openFilePreview",[e.entityId,e.title,e.description,e.type,e.objectUrl,e.downloadUrl,e.webPreviewUrl,e.webEditUrl,e.baseUrl,e.editFile,e.subEntityId,e.viewerAction,e.fileOpenPreference,e.conversationId])}function Ne(e,t,n){if(0===e.length)throw new Error("Must have at least one user when creating a chat deep link");return"https://teams.microsoft.com/l/chat/0/0?users="+e.map(function(e){return encodeURIComponent(e)}).join(",")+(void 0===t?"":"&topicName="+encodeURIComponent(t))+(void 0===n?"":"&message="+encodeURIComponent(n))}!function(e){function t(){return!!z.supports.logs}e.registerGetLogHandler=function(e){if(L(),!t())throw b;e?ee("log.request",function(){_e("log.receive",[e()])}):te("log.request")},e.isSupported=t}(De||(De={})),function(e){e.fileDownloadStart="fileDownloadStart",e.fileDownloadComplete="fileDownloadComplete"}(Ie||(Ie={})),function(e){e.view="view",e.edit="edit",e.editNew="editNew"}(xe||(xe={})),function(e){e.fileOpenPreference="fileOpenPreference",e.theme="theme"}(Ce||(Ce={})),function(e){function t(){return!!z.supports.conversations}e.openConversation=function(e){return new Promise(function(n){if(L(d.content),!t())throw b;var a=ue("conversations.openConversation",{title:e.title,subEntityId:e.subEntityId,conversationId:e.conversationId,channelId:e.channelId,entityId:e.entityId});e.onStartConversation&&ee("startConversation",function(t,n,a,i){return e.onStartConversation({subEntityId:t,conversationId:n,channelId:a,entityId:i})}),e.onCloseConversation&&ee("closeConversation",function(t,n,a,i){return e.onCloseConversation({subEntityId:t,conversationId:n,channelId:a,entityId:i})}),n(a)})},e.closeConversation=function(){if(L(d.content),!t())throw b;_e("conversations.closeConversation"),te("startConversation"),te("closeConversation")},e.getChatMembers=function(){return new Promise(function(e){if(L(),!t())throw b;e(le("getChatMembers"))})},e.isSupported=t}(Oe||(Oe={})),function(e){function t(){return!!z.supports.appInstallDialog}e.openAppInstallDialog=function(e){return new Promise(function(n){if(L(d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),!t())throw new Error("Not supported");z.isLegacyTeams?n(ue("executeDeepLink",function(e){if(!e)throw new Error("App ID must be set when creating an app install dialog deep link");return"https://teams.microsoft.com/l/app/"+encodeURIComponent(e)}(e.appId))):(_e("appInstallDialog.openAppInstallDialog",[e]),n())})},e.isSupported=t}(we||(we={}));var Be,je,Ve,ze,Ge=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}();function Ke(e,t){if(null==e||null==t||e.length<=0)return null;var n,a=1;return e.sort(function(e,t){return e.sequence>t.sequence?1:-1}),e.forEach(function(e){e.sequence==a&&(n=n?new Blob([n,e.file],{type:t}):new Blob([e.file],{type:t}),a++)}),n}function We(e,t){if(null==e||null==t)return null;for(var n=atob(e.chunk),a=new Array(n.length),i=0;i<n.length;i++)a[i]=n.charCodeAt(i);var r=new Uint8Array(a),o=new Blob([r],{type:t});return{sequence:e.chunkSequence,file:o}}function qe(e){return!e||!(null===e.timeOutIntervalInSec||e.timeOutIntervalInSec<=0||e.timeOutIntervalInSec>60)}!function(e){!function(e){e.Base64="base64",e.ID="id"}(e.FileFormat||(e.FileFormat={}));var t=function(){};e.File=t,e.captureImage=function(e){if(!e)throw new Error("[captureImage] Callback cannot be null");L(d.content,d.task),m.isFramelessWindow?k("1.7.0")?_e("captureImage",e):e({errorCode:r.OLD_PLATFORM},void 0):e({errorCode:r.NOT_SUPPORTED_ON_PLATFORM},void 0)};var n=function(e){function t(t){void 0===t&&(t=null);var n=e.call(this)||this;return t&&(n.content=t.content,n.format=t.format,n.mimeType=t.mimeType,n.name=t.name,n.preview=t.preview,n.size=t.size),n}return Ge(t,e),t.prototype.getMedia=function(e){if(!e)throw new Error("[get Media] Callback cannot be null");L(d.content,d.task),k(S)?function(e,t,n){return null!=e&&null!=t&&t==Be.FileFormat.ID&&null!=n}(this.mimeType,this.format,this.content)?k("2.0.0")?this.getMediaViaCallback(e):this.getMediaViaHandler(e):e({errorCode:r.INVALID_ARGUMENTS},null):e({errorCode:r.OLD_PLATFORM},null)},t.prototype.getMediaViaCallback=function(e){var t={mediaMimeType:this.mimeType,assembleAttachment:[]};_e("getMedia",[this.content],function(n){if(e)if(n&&n.error)e(n.error,null);else if(n&&n.mediaChunk)if(n.mediaChunk.chunkSequence<=0){var a=Ke(t.assembleAttachment,t.mediaMimeType);e(n.error,a)}else{var i=We(n.mediaChunk,t.mediaMimeType);t.assembleAttachment.push(i)}else e({errorCode:r.INTERNAL_ERROR,message:"data received is null"},null)})},t.prototype.getMediaViaHandler=function(e){var t=x.v4(),n={mediaMimeType:this.mimeType,assembleAttachment:[]},a=[t,this.content];this.content&&e&&_e("getMedia",a),ee("getMedia"+t,function(a){if(e){var i=JSON.parse(a);if(i.error)e(i.error,null),te("getMedia"+t);else if(i.mediaChunk)if(i.mediaChunk.chunkSequence<=0){var o=Ke(n.assembleAttachment,n.mediaMimeType);e(i.error,o),te("getMedia"+t)}else{var s=We(i.mediaChunk,n.mediaMimeType);n.assembleAttachment.push(s)}else e({errorCode:r.INTERNAL_ERROR,message:"data received is null"},null),te("getMedia"+t)}})},t}(t);e.Media=n;var a,i,o=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Ge(t,e),t.prototype.getMediaType=function(){return i.Video},t.prototype.notifyEventToApp=function(e){if(this.controllerCallback)switch(e){case a.StartRecording:if(this.controllerCallback.onRecordingStarted){this.controllerCallback.onRecordingStarted();break}}},t}(function(){function e(e){this.controllerCallback=e}return e.prototype.notifyEventToHost=function(e,t){L(d.content,d.task);try{M(v)}catch(e){return void(t&&t(e))}_e("media.controller",[{mediaType:this.getMediaType(),mediaControllerEvent:e}],function(e){t&&t(e)})},e.prototype.stop=function(e){this.notifyEventToHost(a.StopRecording,e)},e}());e.VideoController=o,function(e){e[e.StartRecording=1]="StartRecording",e[e.StopRecording=2]="StopRecording"}(a=e.MediaControllerEvent||(e.MediaControllerEvent={})),function(e){e[e.Photo=1]="Photo",e[e.Document=2]="Document",e[e.Whiteboard=3]="Whiteboard",e[e.BusinessCard=4]="BusinessCard"}(e.CameraStartMode||(e.CameraStartMode={})),function(e){e[e.Camera=1]="Camera",e[e.Gallery=2]="Gallery"}(e.Source||(e.Source={})),function(e){e[e.Image=1]="Image",e[e.Video=2]="Video",e[e.VideoAndImage=3]="VideoAndImage",e[e.Audio=4]="Audio"}(i=e.MediaType||(e.MediaType={})),function(e){e[e.ID=1]="ID",e[e.URL=2]="URL"}(e.ImageUriType||(e.ImageUriType={})),function(e){e[e.IMAGE=1]="IMAGE",e[e.PDF=2]="PDF"}(e.ImageOutputFormats||(e.ImageOutputFormats={})),e.selectMedia=function(e,t){if(!t)throw new Error("[select Media] Callback cannot be null");if(L(d.content,d.task),k(S)){try{!function(e){!function(e){return!(!e||e.mediaType!=Be.MediaType.VideoAndImage&&!e.videoAndImageProps)}(e)?function(e){return!(!e||e.mediaType!=Be.MediaType.Video||!e.videoProps||e.videoProps.isFullScreenMode)}(e)?M(v):function(e){var t;return!((null==e?void 0:e.mediaType)!=Be.MediaType.Image||!(null===(t=null==e?void 0:e.imageProps)||void 0===t?void 0:t.imageOutputFormats))}(e)&&M("2.0.4"):M("2.0.2")}(e)}catch(e){return void t(e,null)}if(function(e){return!(null==e||e.maxMediaCount>10)}(e))_e("selectMedia",[e],function(a,i,r){if(r)(function(e){return!(e.mediaType!=Be.MediaType.Video||!e.videoProps||!e.videoProps.videoController)})(e)&&e.videoProps.videoController.notifyEventToApp(r);else if(i){for(var o=[],s=0,c=i;s<c.length;s++){var d=c[s];o.push(new n(d))}t(a,o)}else t(a,null)});else{var a={errorCode:r.INVALID_ARGUMENTS};t(a,null)}}else{var i={errorCode:r.OLD_PLATFORM};t(i,null)}},e.viewImages=function(e,t){if(!t)throw new Error("[view images] Callback cannot be null");L(d.content,d.task),k(S)?function(e){return!(null==e||e.length<=0||e.length>10)}(e)?_e("viewImages",[e],t):t({errorCode:r.INVALID_ARGUMENTS}):t({errorCode:r.OLD_PLATFORM})},e.scanBarCode=function(e,t){if(!e)throw new Error("[media.scanBarCode] Callback cannot be null");L(d.content,d.task),m.hostClientType!==s.desktop&&m.hostClientType!==s.web&&m.hostClientType!==s.rigel&&m.hostClientType!==s.teamsRoomsWindows&&m.hostClientType!==s.teamsRoomsAndroid&&m.hostClientType!==s.teamsPhones&&m.hostClientType!==s.teamsDisplays?k("1.9.0")?qe(t)?_e("media.scanBarCode",[t],e):e({errorCode:r.INVALID_ARGUMENTS},null):e({errorCode:r.OLD_PLATFORM},null):e({errorCode:r.NOT_SUPPORTED_ON_PLATFORM},null)}}(Be||(Be={})),function(e){function t(){return!(!z.supports.barCode||!z.supports.permissions)}e.scanBarCode=function(e){return new Promise(function(n){if(L(d.content,d.task),!t())throw b;if(!qe(e))throw{errorCode:r.INVALID_ARGUMENTS};n(pe("media.scanBarCode",e))})},e.hasPermission=function(){if(L(d.content,d.task),!t())throw b;var e=o.Media;return new Promise(function(t){t(pe("permissions.has",e))})},e.requestPermission=function(){if(L(d.content,d.task),!t())throw b;var e=o.Media;return new Promise(function(t){t(pe("permissions.request",e))})},e.isSupported=t}(je||(je={})),function(e){function t(e){return new Promise(function(t){if(L(d.content,d.task),!n())throw b;z.isLegacyTeams?t(ue("executeDeepLink",Ne([e.user],void 0,e.message))):t(ue("chat.openChat",{members:e.user,message:e.message}))})}function n(){return!!z.supports.chat}e.openChat=t,e.openGroupChat=function(e){return new Promise(function(a){if(e.users.length<1)throw Error("OpenGroupChat Failed: No users specified");if(1===e.users.length)t({user:e.users[0],message:e.message});else{if(L(d.content,d.task),!n())throw b;z.isLegacyTeams?a(ue("executeDeepLink",Ne(e.users,e.topic,e.message))):a(ue("chat.openChat",{members:e.users,message:e.message,topic:e.topic}))}})},e.isSupported=n}(Ve||(Ve={})),function(e){function t(){return!(!z.supports.geoLocation||!z.supports.permissions)}e.getCurrentLocation=function(){if(L(d.content,d.task),!t())throw b;return pe("location.getLocation",{allowChooseLocation:!1,showMap:!1})},e.hasPermission=function(){if(L(d.content,d.task),!t())throw b;var e=o.GeoLocation;return new Promise(function(t){t(pe("permissions.has",e))})},e.requestPermission=function(){if(L(d.content,d.task),!t())throw b;var e=o.GeoLocation;return new Promise(function(t){t(pe("permissions.request",e))})},e.isSupported=t,function(e){function t(){return!!(z.supports.geoLocation&&z.supports.geoLocation.map&&z.supports.permissions)}e.chooseLocation=function(){if(L(d.content,d.task),!t())throw b;return pe("location.getLocation",{allowChooseLocation:!0,showMap:!0})},e.showLocation=function(e){if(L(d.content,d.task),!t())throw b;if(!e)throw{errorCode:r.INVALID_ARGUMENTS};return pe("location.showLocation",e)},e.isSupported=t}(e.map||(e.map={}))}(ze||(ze={}));var Qe,Ye,Je,Xe,Ze,$e,et,tt,nt,at,it,rt,ot,st,ct,dt,lt,ut,ft,pt,mt,_t,ht,bt=function(){function e(){}return e.prototype.postMessage=function(e,t){L(),_e("messageForChild",[e],t||O())},e.prototype.addEventListener=function(e,t){L(),"message"===e&&ee("messageForParent",t)},e}(),gt=function(){function e(){}return Object.defineProperty(e,"Instance",{get:function(){return this._instance||(this._instance=new this)},enumerable:!1,configurable:!0}),e.prototype.postMessage=function(e,t){L(d.task),_e("messageForParent",[e],t||O())},e.prototype.addEventListener=function(e,t){L(d.task),"message"===e&&ee("messageForChild",t)},e}();function vt(e,t){N.initialize(t).then(function(){e&&e()})}function yt(){R.enablePrintCapability()}function St(){R.print()}function Dt(e){L(),N.getContext().then(function(t){e&&e(function(e){return{actionInfo:e.actionInfo,locale:e.app.locale,appSessionId:e.app.sessionId,theme:e.app.theme,appIconPosition:e.app.iconPositionVertical,osLocaleInfo:e.app.osLocaleInfo,parentMessageId:e.app.parentMessageId,userClickTime:e.app.userClickTime,userFileOpenPreference:e.app.userFileOpenPreference,appLaunchId:e.app.appLaunchId,hostClientType:e.app.host.clientType,sessionId:e.app.host.sessionId,ringId:e.app.host.ringId,entityId:e.page.id,frameContext:e.page.frameContext,subEntityId:e.page.subPageId,isFullScreen:e.page.isFullScreen,isMultiWindow:e.page.isMultiWindow,sourceOrigin:e.page.sourceOrigin,userObjectId:void 0!==e.user?e.user.id:void 0,isCallingAllowed:void 0!==e.user?e.user.isCallingAllowed:void 0,isPSTNCallingAllowed:void 0!==e.user?e.user.isPSTNCallingAllowed:void 0,userLicenseType:void 0!==e.user?e.user.licenseType:void 0,loginHint:void 0!==e.user?e.user.loginHint:void 0,userPrincipalName:void 0!==e.user?e.user.userPrincipalName:void 0,tid:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.id:void 0,tenantSKU:void 0!==e.user&&void 0!==e.user.tenant?e.user.tenant.teamsSku:void 0,channelId:void 0!==e.channel?e.channel.id:void 0,channelName:void 0!==e.channel?e.channel.displayName:void 0,channelRelativeUrl:void 0!==e.channel?e.channel.relativeUrl:void 0,channelType:void 0!==e.channel?e.channel.membershipType:void 0,defaultOneNoteSectionId:void 0!==e.channel?e.channel.defaultOneNoteSectionId:void 0,hostTeamGroupId:void 0!==e.channel?e.channel.ownerGroupId:void 0,hostTeamTenantId:void 0!==e.channel?e.channel.ownerTenantId:void 0,chatId:void 0!==e.chat?e.chat.id:void 0,meetingId:void 0!==e.meeting?e.meeting.id:void 0,sharepoint:e.sharepoint,teamId:void 0!==e.team?e.team.internalId:void 0,teamName:void 0!==e.team?e.team.displayName:void 0,teamType:void 0!==e.team?e.team.type:void 0,groupId:void 0!==e.team?e.team.groupId:void 0,teamTemplateId:void 0!==e.team?e.team.templateId:void 0,isTeamArchived:void 0!==e.team?e.team.isArchived:void 0,userTeamRole:void 0!==e.team?e.team.userRole:void 0,teamSiteUrl:void 0!==e.sharePointSite?e.sharePointSite.teamSiteUrl:void 0,teamSiteDomain:void 0!==e.sharePointSite?e.sharePointSite.teamSiteDomain:void 0,teamSitePath:void 0!==e.sharePointSite?e.sharePointSite.teamSitePath:void 0,teamSiteId:void 0!==e.sharePointSite?e.sharePointSite.teamSiteId:void 0,mySitePath:void 0!==e.sharePointSite?e.sharePointSite.mySitePath:void 0,mySiteDomain:void 0!==e.sharePointSite?e.sharePointSite.mySiteDomain:void 0}}(t))})}function It(e){N.registerOnThemeChangeHandler(e)}function xt(e){ne("fullScreenChange",e,[])}function Ct(e){ne("appButtonClick",e,[d.content])}function Ot(e){ne("appButtonHoverEnter",e,[d.content])}function wt(e){ne("appButtonHoverLeave",e,[d.content])}function Et(e){B.backStack.registerBackButtonHandlerHelper(e)}function At(e){R.registerOnLoadHandlerHelper(e)}function Lt(e){R.registerBeforeUnloadHandlerHelper(e)}function kt(e){ne("focusEnter",e,[])}function Mt(e){ne("changeSettings",e,[d.content])}function Pt(e,t){L(),B.tabs.getTabInstances(t).then(function(t){e(t)})}function Tt(e,t){L(),B.tabs.getMruTabInstances(t).then(function(t){e(t)})}function Ut(e){B.shareDeepLink({subPageId:e.subEntityId,subPageLabel:e.subEntityLabel,subPageWebUrl:e.subEntityWebUrl})}function Ft(e,t){L(d.content,d.sidePanel,d.settings,d.task,d.stage,d.meetingStage),t=t||O(),N.openLink(e).then(function(){t(!0)}).catch(function(e){t(!1,e.message)})}function Ht(e){B.setCurrentFrame(e)}function Rt(e,t,n){B.initializeWithFrameContext(e,t,n)}function Nt(e){B.returnFocus(e)}function Bt(e,t){L(),t=t||O(),B.tabs.navigateToTab(e).then(function(){t(!0)}).catch(function(e){t(!1,e.message)})}function jt(e,t){L(d.content,d.sidePanel,d.settings,d.remove,d.task,d.stage,d.meetingStage),t=t||O(),B.navigateCrossDomain(e).then(function(){t(!0)}).catch(function(e){t(!1,e.message)})}function Vt(e){L(),e=e||O(),B.backStack.navigateBack().then(function(){e(!0)}).catch(function(t){e(!1,t.message)})}!function(e){function t(){return!!z.supports.location}e.getLocation=function(e,n){if(!n)throw new Error("[location.getLocation] Callback cannot be null");if(L(d.content,d.task),!k(y))throw{errorCode:r.OLD_PLATFORM};if(!e)throw{errorCode:r.INVALID_ARGUMENTS};if(!t())throw b;_e("location.getLocation",[e],n)},e.showLocation=function(e,n){if(!n)throw new Error("[location.showLocation] Callback cannot be null");if(L(d.content,d.task),!k(y))throw{errorCode:r.OLD_PLATFORM};if(!e)throw{errorCode:r.INVALID_ARGUMENTS};if(!t())throw b;_e("location.showLocation",[e],n)},e.isSupported=t}(Qe||(Qe={})),function(e){!function(e){e.like="like",e.heart="heart",e.laugh="laugh",e.surprised="surprised",e.applause="applause"}(e.MeetingReactionType||(e.MeetingReactionType={})),function(e){e.Unknown="Unknown",e.Adhoc="Adhoc",e.Scheduled="Scheduled",e.Recurring="Recurring",e.Broadcast="Broadcast",e.MeetNow="MeetNow"}(e.MeetingType||(e.MeetingType={})),function(e){e.OneOnOneCall="oneOnOneCall",e.GroupCall="groupCall"}(e.CallType||(e.CallType={})),e.getIncomingClientAudioState=function(e){if(!e)throw new Error("[get incoming client audio state] Callback cannot be null");L(d.sidePanel,d.meetingStage),_e("getIncomingClientAudioState",e)},e.toggleIncomingClientAudio=function(e){if(!e)throw new Error("[toggle incoming client audio] Callback cannot be null");L(d.sidePanel,d.meetingStage),_e("toggleIncomingClientAudio",e)},e.getMeetingDetails=function(e){if(!e)throw new Error("[get meeting details] Callback cannot be null");L(d.sidePanel,d.meetingStage,d.settings,d.content),_e("meeting.getMeetingDetails",e)},e.getAuthenticationTokenForAnonymousUser=function(e){if(!e)throw new Error("[get Authentication Token For AnonymousUser] Callback cannot be null");L(d.sidePanel,d.meetingStage),_e("meeting.getAuthenticationTokenForAnonymousUser",e)},e.getLiveStreamState=function(e){if(!e)throw new Error("[get live stream state] Callback cannot be null");L(d.sidePanel),_e("meeting.getLiveStreamState",e)},e.requestStartLiveStreaming=function(e,t,n){if(!e)throw new Error("[request start live streaming] Callback cannot be null");L(d.sidePanel),_e("meeting.requestStartLiveStreaming",[t,n],e)},e.requestStopLiveStreaming=function(e){if(!e)throw new Error("[request stop live streaming] Callback cannot be null");L(d.sidePanel),_e("meeting.requestStopLiveStreaming",e)},e.registerLiveStreamChangedHandler=function(e){if(!e)throw new Error("[register live stream changed handler] Handler cannot be null");L(d.sidePanel),ee("meeting.liveStreamChanged",e)},e.shareAppContentToStage=function(e,t){if(!e)throw new Error("[share app content to stage] Callback cannot be null");L(d.sidePanel,d.meetingStage),_e("meeting.shareAppContentToStage",[t],e)},e.getAppContentStageSharingCapabilities=function(e){if(!e)throw new Error("[get app content stage sharing capabilities] Callback cannot be null");L(d.sidePanel,d.meetingStage),_e("meeting.getAppContentStageSharingCapabilities",e)},e.stopSharingAppContentToStage=function(e){if(!e)throw new Error("[stop sharing app content to stage] Callback cannot be null");L(d.sidePanel,d.meetingStage),_e("meeting.stopSharingAppContentToStage",e)},e.getAppContentStageSharingState=function(e){if(!e)throw new Error("[get app content stage sharing state] Callback cannot be null");L(d.sidePanel,d.meetingStage),_e("meeting.getAppContentStageSharingState",e)},e.registerSpeakingStateChangeHandler=function(e){if(!e)throw new Error("[registerSpeakingStateChangeHandler] Handler cannot be null");L(d.sidePanel,d.meetingStage),ee("meeting.speakingStateChanged",e)},e.registerRaiseHandStateChangedHandler=function(e){if(!e)throw new Error("[registerRaiseHandStateChangedHandler] Handler cannot be null");L(d.sidePanel,d.meetingStage),ee("meeting.raiseHandStateChanged",e)},e.registerMeetingReactionReceivedHandler=function(e){if(!e)throw new Error("[registerMeetingReactionReceivedHandler] Handler cannot be null");L(d.sidePanel,d.meetingStage),ee("meeting.meetingReactionReceived",e)}}(Ye||(Ye={})),function(e){function t(){return!!z.supports.monetization}e.openPurchaseExperience=function(e,n){var a,i;return"function"==typeof e?(a=e,i=n):i=e,L(d.content),function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e.apply(void 0,n);return i.then(function(e){t&&t(null,e)}).catch(function(e){t&&t(e,null)}),i}(function(){return new Promise(function(e){if(!t())throw b;e(pe("monetization.openPurchaseExperience",i))})},a)},e.isSupported=t}(Je||(Je={})),function(e){function t(){return!!z.supports.calendar}e.openCalendarItem=function(e){return new Promise(function(n){if(L(d.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openCalendarItem");n(ue("calendar.openCalendarItem",e))})},e.composeMeeting=function(e){return new Promise(function(n){if(L(d.content),!t())throw new Error("Not supported");z.isLegacyTeams?n(ue("executeDeepLink",function(e,t,n,a,i){return"https://teams.microsoft.com/l/meeting/new?"+(void 0===e?"":"attendees="+e.map(function(e){return encodeURIComponent(e)}).join(","))+(void 0===t?"":"&startTime="+encodeURIComponent(t))+(void 0===n?"":"&endTime="+encodeURIComponent(n))+(void 0===a?"":"&subject="+encodeURIComponent(a))+(void 0===i?"":"&content="+encodeURIComponent(i))}(e.attendees,e.startTime,e.endTime,e.subject,e.content))):n(ue("calendar.composeMeeting",e))})},e.isSupported=t}(Xe||(Xe={})),function(e){function t(){return!!z.supports.mail}e.openMailItem=function(e){return new Promise(function(n){if(L(d.content),!t())throw new Error("Not supported");if(!e.itemId||!e.itemId.trim())throw new Error("Must supply an itemId to openMailItem");n(ue("mail.openMailItem",e))})},e.composeMail=function(e){return new Promise(function(n){if(L(d.content),!t())throw new Error("Not supported");n(ue("mail.composeMail",e))})},e.isSupported=t,function(e){e.New="new",e.Reply="reply",e.ReplyAll="replyAll",e.Forward="forward"}(e.ComposeMailType||(e.ComposeMailType={}))}(Ze||(Ze={})),function(e){function t(e){return new Promise(function(t){if(!k("2.0.0"))throw{errorCode:r.OLD_PLATFORM};if(!function(e){if(e){if(e.title&&"string"!=typeof e.title)return!1;if(e.setSelected&&"object"!=typeof e.setSelected)return!1;if(e.openOrgWideSearchInChatOrChannel&&"boolean"!=typeof e.openOrgWideSearchInChatOrChannel)return!1;if(e.singleSelect&&"boolean"!=typeof e.singleSelect)return!1}return!0}(e))throw{errorCode:r.INVALID_ARGUMENTS};if(!n())throw b;t(pe("people.selectPeople",e))})}function n(){return!!z.supports.people}e.selectPeople=function(e,n){var a,i,r;return L(d.content,d.task,d.settings),"function"==typeof e?(i=(a=[e,n])[0],r=a[1]):r=e,function(e,t){for(var n=[],a=2;a<arguments.length;a++)n[a-2]=arguments[a];var i=e.apply(void 0,n);return i.then(function(e){t&&t(void 0,e)}).catch(function(e){t&&t(e)}),i}(t,i,r)},e.isSupported=n}($e||($e={})),function(e){e.showProfile=function(e){return L(d.content),new Promise(function(t){var n=function(e){return e?e.modality&&"string"!=typeof e.modality?[!1,"modality must be a string"]:e.targetElementBoundingRect&&"object"==typeof e.targetElementBoundingRect?e.triggerType&&"string"==typeof e.triggerType?function(e){return e?e.displayName&&"string"!=typeof e.displayName?[!1,"displayName must be a string"]:e.identifiers&&"object"==typeof e.identifiers?e.identifiers.AadObjectId||e.identifiers.Smtp||e.identifiers.Upn?e.identifiers.AadObjectId&&"string"!=typeof e.identifiers.AadObjectId?[!1,"AadObjectId identifier must be a string"]:e.identifiers.Smtp&&"string"!=typeof e.identifiers.Smtp?[!1,"Smtp identifier must be a string"]:e.identifiers.Upn&&"string"!=typeof e.identifiers.Upn?[!1,"Upn identifier must be a string"]:[!0,void 0]:[!1,"at least one valid identifier must be provided"]:[!1,"persona identifiers object must be provided"]:[!1,"persona object must be provided"]}(e.persona):[!1,"triggerType must be a valid string"]:[!1,"targetElementBoundingRect must be a DOMRect"]:[!1,"A request object is required"]}(e),a=n[0],i=n[1];if(!a)throw{errorCode:r.INVALID_ARGUMENTS,message:i};t(pe("profile.showProfile",{modality:e.modality,persona:e.persona,triggerType:e.triggerType,targetRectangle:{x:e.targetElementBoundingRect.x,y:e.targetElementBoundingRect.y,width:e.targetElementBoundingRect.width,height:e.targetElementBoundingRect.height}}))})},e.isSupported=function(){return!!z.supports.profile}}(et||(et={})),function(e){function t(e){_e("video.notifyError",[e])}function n(){return!!z.supports.video}!function(e){e[e.NV12=0]="NV12"}(e.VideoFrameFormat||(e.VideoFrameFormat={})),function(e){e[e.EffectChanged=0]="EffectChanged",e[e.EffectDisabled=1]="EffectDisabled"}(e.EffectChangeType||(e.EffectChangeType={})),e.registerForVideoFrame=function(e,a){if(L(d.sidePanel),!n())throw b;ee("video.newVideoFrame",function(n){if(n){var a=n.timestamp;e(n,function(){!function(e){_e("video.videoFrameProcessed",[e])}(a)},t)}},!1),_e("video.registerForVideoFrame",[a])},e.notifySelectedVideoEffectChanged=function(e,t){if(L(d.sidePanel),!n())throw b;_e("video.videoEffectChanged",[e,t])},e.registerForVideoEffect=function(e){if(L(d.sidePanel),!n())throw b;ee("video.effectParameterChange",e,!1),_e("video.registerForVideoEffect")},e.isSupported=n}(tt||(tt={})),function(e){var t="search.queryChange",n="search.queryClose",a="search.queryExecute";function i(){return!!z.supports.search}e.registerHandlers=function(e,r,o){if(L(d.content),!i())throw b;ee(n,e),ee(a,r),o&&ee(t,o)},e.unregisterHandlers=function(){if(L(d.content),!i())throw b;_e("search.unregister"),te(t),te(n),te(a)},e.isSupported=i}(nt||(nt={})),function(e){function t(t){return new Promise(function(n){if(!o())throw b;n(pe(e.SharingAPIMessages.shareWebContent,t))})}function n(e){if(!(e&&e.content&&e.content.length))throw{errorCode:r.INVALID_ARGUMENTS,message:"Shared content is missing"}}function a(e){if(e.content.some(function(e){return!e.type}))throw{errorCode:r.INVALID_ARGUMENTS,message:"Shared content type cannot be undefined"};if(e.content.some(function(t){return t.type!==e.content[0].type}))throw{errorCode:r.INVALID_ARGUMENTS,message:"Shared content must be of the same type"}}function i(e){if("URL"!==e.content[0].type)throw{errorCode:r.INVALID_ARGUMENTS,message:"Content type is unsupported"};if(e.content.some(function(e){return!e.url}))throw{errorCode:r.INVALID_ARGUMENTS,message:"URLs are required for URL content types"}}function o(){return!!z.supports.sharing}e.SharingAPIMessages={shareWebContent:"sharing.shareWebContent"},e.shareWebContent=function(e,r){try{n(e),a(e),i(e)}catch(e){return A(function(){return Promise.reject(e)},r)}return L(d.content,d.sidePanel,d.task,d.stage,d.meetingStage),A(t,r,e)},e.isSupported=o}(at||(at={})),function(e){function t(){return!!z.supports.stageView}e.open=function(e){return new Promise(function(n){if(L(d.content),!t())throw b;if(!e)throw new Error("[stageView.open] Stage view params cannot be null");n(pe("stageView.open",e))})},e.isSupported=t}(it||(it={})),function(e){function t(){return!!z.supports.webStorage}e.isWebStorageClearedOnUserLogOut=function(){return L(),t()},e.isSupported=t}(rt||(rt={})),function(e){var t;function n(){return!!z.supports.call}!function(e){e.Unknown="unknown",e.Audio="audio",e.Video="video",e.VideoBasedScreenSharing="videoBasedScreenSharing",e.Data="data"}(t=e.CallModalities||(e.CallModalities={})),e.startCall=function(e){return new Promise(function(a){var i;if(L(d.content,d.task),!n())throw b;if(!z.isLegacyTeams)return _e("call.startCall",[e],a);a(pe("executeDeepLink",function(e,t,n){if(0===e.length)throw new Error("Must have at least one target when creating a call deep link");return"https://teams.microsoft.com/l/call/0/0?users="+e.map(function(e){return encodeURIComponent(e)}).join(",")+(void 0===t?"":"&withVideo="+encodeURIComponent(t))+(void 0===n?"":"&source="+encodeURIComponent(n))}(e.targets,null===(i=e.requestedModalities)||void 0===i?void 0:i.includes(t.Video),e.source)))})},e.isSupported=n}(ot||(ot={})),function(e){e.Messages=N.Messages,e.FailedReason=N.FailedReason,e.ExpectedFailureReason=N.ExpectedFailureReason,e.notifyAppLoaded=function(){N.notifyAppLoaded()},e.notifySuccess=function(){N.notifySuccess()},e.notifyFailure=function(e){N.notifyFailure(e)},e.notifyExpectedFailure=function(e){N.notifyExpectedFailure(e)}}(st||(st={})),function(e){e.setValidityState=function(e){B.config.setValidityState(e)},e.getSettings=function(e){L(d.content,d.settings,d.remove,d.sidePanel),B.getConfig().then(function(t){e(t)})},e.setSettings=function(e,t){L(d.content,d.settings,d.sidePanel),t=t||O(),B.config.setConfig(e).then(function(){t(!0)}).catch(function(e){t(!1,e.message)})},e.registerOnSaveHandler=function(e){B.config.registerOnSaveHandlerHelper(e)},e.registerOnRemoveHandler=function(e){B.config.registerOnRemoveHandlerHelper(e)}}(ct||(ct={})),function(e){function t(e){return e.height=e.height?e.height:h.Small,e.width=e.width?e.width:h.Small,e}e.startTask=function(e,t){var n=t?function(e){return t(e.err,e.result)}:void 0;return void 0!==e.card||void 0===e.url?(L(d.content,d.sidePanel,d.meetingStage),_e("tasks.startTask",[e],t)):void 0!==e.completionBotId?F.bot.open(function(e){return{url:e.url,size:{height:e.height?e.height:h.Small,width:e.width?e.width:h.Small},title:e.title,fallbackUrl:e.fallbackUrl,completionBotId:e.completionBotId}}(e),n):F.open(function(e){return{url:e.url,size:{height:e.height?e.height:h.Small,width:e.width?e.width:h.Small},title:e.title,fallbackUrl:e.fallbackUrl}}(e),n),new bt},e.updateTask=function(e){(e=t(e)).width,e.height;var n=function(e,t){var n={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(a=Object.getOwnPropertySymbols(e);i<a.length;i++)t.indexOf(a[i])<0&&Object.prototype.propertyIsEnumerable.call(e,a[i])&&(n[a[i]]=e[a[i]])}return n}(e,["width","height"]);if(Object.keys(n).length)throw new Error("resize requires a TaskInfo argument containing only width and height");F.update.resize(e)},e.submitTask=function(e,t){F.submit(e,t)},e.getDefaultSizeIfNotProvided=t}(dt||(dt={})),function(e){function t(e,t){return{errorCode:e,message:t}}!function(e){e.Dropbox="DROPBOX",e.Box="BOX",e.Sharefile="SHAREFILE",e.GoogleDrive="GOOGLEDRIVE",e.Egnyte="EGNYTE",e.SharePoint="SharePoint"}(e.CloudStorageProvider||(e.CloudStorageProvider={})),function(e){e[e.Sharepoint=0]="Sharepoint",e[e.WopiIntegration=1]="WopiIntegration",e[e.Google=2]="Google",e[e.OneDrive=3]="OneDrive",e[e.Recent=4]="Recent",e[e.Aggregate=5]="Aggregate",e[e.FileSystem=6]="FileSystem",e[e.Search=7]="Search",e[e.AllFiles=8]="AllFiles",e[e.SharedWithMe=9]="SharedWithMe"}(e.CloudStorageProviderType||(e.CloudStorageProviderType={})),function(e){e.ClassMaterials="classMaterials"}(e.SpecialDocumentLibraryType||(e.SpecialDocumentLibraryType={})),function(e){e.Readonly="readonly"}(e.DocumentLibraryAccessType||(e.DocumentLibraryAccessType={})),function(e){e.Downloaded="Downloaded",e.Downloading="Downloading",e.Failed="Failed"}(e.FileDownloadStatus||(e.FileDownloadStatus={})),function(e){e.Download="DOWNLOAD",e.Upload="UPLOAD",e.Delete="DELETE"}(e.CloudStorageProviderFileAction||(e.CloudStorageProviderFileAction={})),e.getCloudStorageFolders=function(e,t){if(L(d.content),!e||0===e.length)throw new Error("[files.getCloudStorageFolders] channelId name cannot be null or empty");if(!t)throw new Error("[files.getCloudStorageFolders] Callback cannot be null");_e("files.getCloudStorageFolders",[e],t)},e.addCloudStorageFolder=function(e,t){if(L(d.content),!e||0===e.length)throw new Error("[files.addCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.addCloudStorageFolder] Callback cannot be null");_e("files.addCloudStorageFolder",[e],t)},e.deleteCloudStorageFolder=function(e,t,n){if(L(d.content),!e)throw new Error("[files.deleteCloudStorageFolder] channelId name cannot be null or empty");if(!t)throw new Error("[files.deleteCloudStorageFolder] folderToDelete cannot be null or empty");if(!n)throw new Error("[files.deleteCloudStorageFolder] Callback cannot be null");_e("files.deleteCloudStorageFolder",[e,t],n)},e.getCloudStorageFolderContents=function(e,t,n){if(L(d.content),!e||!t)throw new Error("[files.getCloudStorageFolderContents] folder/providerCode name cannot be null or empty");if(!n)throw new Error("[files.getCloudStorageFolderContents] Callback cannot be null");if("isSubdirectory"in e&&!e.isSubdirectory)throw new Error("[files.getCloudStorageFolderContents] provided folder is not a subDirectory");_e("files.getCloudStorageFolderContents",[e,t],n)},e.openCloudStorageFile=function(e,t,n){if(L(d.content),!e||!t)throw new Error("[files.openCloudStorageFile] file/providerCode cannot be null or empty");if(e.isSubdirectory)throw new Error("[files.openCloudStorageFile] provided file is a subDirectory");_e("files.openCloudStorageFile",[e,t,n])},e.getExternalProviders=function(e,t){if(void 0===e&&(e=!1),L(d.content),!t)throw new Error("[files.getExternalProviders] Callback cannot be null");_e("files.getExternalProviders",[e],t)},e.copyMoveFiles=function(e,t,n,a,i,r){if(void 0===i&&(i=!1),L(d.content),!e||0===e.length)throw new Error("[files.copyMoveFiles] selectedFiles cannot be null or empty");if(!t)throw new Error("[files.copyMoveFiles] providerCode cannot be null or empty");if(!n)throw new Error("[files.copyMoveFiles] destinationFolder cannot be null or empty");if(!a)throw new Error("[files.copyMoveFiles] destinationProviderCode cannot be null or empty");if(!r)throw new Error("[files.copyMoveFiles] callback cannot be null");_e("files.copyMoveFiles",[e,t,n,a,i],r)},e.getFileDownloads=function(e){if(L(d.content),!e)throw new Error("[files.getFileDownloads] Callback cannot be null");_e("files.getFileDownloads",[],e)},e.openDownloadFolder=function(e,t){if(void 0===e&&(e=void 0),L(d.content),!t)throw new Error("[files.openDownloadFolder] Callback cannot be null");_e("files.openDownloadFolder",[e],t)},e.addCloudStorageProvider=function(e){if(L(d.content),!e)throw t(r.INVALID_ARGUMENTS,"[files.addCloudStorageProvider] callback cannot be null");_e("files.addCloudStorageProvider",[],e)},e.removeCloudStorageProvider=function(e,n){if(L(d.content),!n)throw t(r.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] callback cannot be null");if(!e||!e.content)throw t(r.INVALID_ARGUMENTS,"[files.removeCloudStorageProvider] 3P cloud storage provider request content is missing");_e("files.removeCloudStorageProvider",[e],n)},e.addCloudStorageProviderFile=function(e,n){if(L(d.content),!n)throw t(r.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw t(r.INVALID_ARGUMENTS,"[files.addCloudStorageProviderFile] 3P cloud storage provider request content is missing");_e("files.addCloudStorageProviderFile",[e],n)},e.renameCloudStorageProviderFile=function(e,n){if(L(d.content),!n)throw t(r.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] callback cannot be null");if(!e||!e.content)throw t(r.INVALID_ARGUMENTS,"[files.renameCloudStorageProviderFile] 3P cloud storage provider request content is missing");_e("files.renameCloudStorageProviderFile",[e],n)},e.deleteCloudStorageProviderFile=function(e,n){if(L(d.content),!n)throw t(r.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(r.INVALID_ARGUMENTS,"[files.deleteCloudStorageProviderFile] 3P cloud storage provider request content details are missing");_e("files.deleteCloudStorageProviderFile",[e],n)},e.downloadCloudStorageProviderFile=function(e,n){if(L(d.content),!n)throw t(r.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(r.INVALID_ARGUMENTS,"[files.downloadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");_e("files.downloadCloudStorageProviderFile",[e],n)},e.uploadCloudStorageProviderFile=function(e,n){if(L(d.content),!n)throw t(r.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] callback cannot be null");if(!(e&&e.content&&e.content.itemList&&e.content.itemList.length>0))throw t(r.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] 3P cloud storage provider request content details are missing");if(!e.content.destinationFolder)throw t(r.INVALID_ARGUMENTS,"[files.uploadCloudStorageProviderFile] Invalid destination folder details");_e("files.uploadCloudStorageProviderFile",[e],n)},e.registerCloudStorageProviderListChangeHandler=function(e){if(L(),!e)throw new Error("[registerCloudStorageProviderListChangeHandler] Handler cannot be null");ee("files.cloudStorageProviderListChange",e)},e.registerCloudStorageProviderContentChangeHandler=function(e){if(L(),!e)throw new Error("[registerCloudStorageProviderContentChangeHandler] Handler cannot be null");ee("files.cloudStorageProviderContentChange",e)}}(lt||(lt={})),function(e){function t(){return!!z.supports.meetingRoom}e.getPairedMeetingRoomInfo=function(){return new Promise(function(e){if(L(),!t())throw b;e(pe("meetingRoom.getPairedMeetingRoomInfo"))})},e.sendCommandToPairedMeetingRoom=function(e){return new Promise(function(n){if(!e||0==e.length)throw new Error("[meetingRoom.sendCommandToPairedMeetingRoom] Command name cannot be null or empty");if(L(),!t())throw b;n(pe("meetingRoom.sendCommandToPairedMeetingRoom",e))})},e.registerMeetingRoomCapabilitiesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomCapabilitiesUpdateHandler] Handler cannot be null");if(L(),!t())throw b;ee("meetingRoom.meetingRoomCapabilitiesUpdate",function(t){L(),e(t)})},e.registerMeetingRoomStatesUpdateHandler=function(e){if(!e)throw new Error("[meetingRoom.registerMeetingRoomStatesUpdateHandler] Handler cannot be null");if(L(),!t())throw b;ee("meetingRoom.meetingRoomStatesUpdate",function(t){L(),e(t)})},e.isSupported=t}(ut||(ut={})),function(e){function t(){return!!z.supports.notifications}e.showNotification=function(e){if(L(d.content),!t())throw b;_e("notifications.showNotification",[e])},e.isSupported=t}(ft||(ft={})),function(e){function t(){return!!z.supports.remoteCamera}!function(e){e.Reset="Reset",e.ZoomIn="ZoomIn",e.ZoomOut="ZoomOut",e.PanLeft="PanLeft",e.PanRight="PanRight",e.TiltUp="TiltUp",e.TiltDown="TiltDown"}(e.ControlCommand||(e.ControlCommand={})),function(e){e[e.CommandResetError=0]="CommandResetError",e[e.CommandZoomInError=1]="CommandZoomInError",e[e.CommandZoomOutError=2]="CommandZoomOutError",e[e.CommandPanLeftError=3]="CommandPanLeftError",e[e.CommandPanRightError=4]="CommandPanRightError",e[e.CommandTiltUpError=5]="CommandTiltUpError",e[e.CommandTiltDownError=6]="CommandTiltDownError",e[e.SendDataError=7]="SendDataError"}(e.ErrorReason||(e.ErrorReason={})),function(e){e[e.None=0]="None",e[e.ControlDenied=1]="ControlDenied",e[e.ControlNoResponse=2]="ControlNoResponse",e[e.ControlBusy=3]="ControlBusy",e[e.AckTimeout=4]="AckTimeout",e[e.ControlTerminated=5]="ControlTerminated",e[e.ControllerTerminated=6]="ControllerTerminated",e[e.DataChannelError=7]="DataChannelError",e[e.ControllerCancelled=8]="ControllerCancelled",e[e.ControlDisabled=9]="ControlDisabled",e[e.ControlTerminatedToAllowOtherController=10]="ControlTerminatedToAllowOtherController"}(e.SessionTerminatedReason||(e.SessionTerminatedReason={})),e.getCapableParticipants=function(e){if(!e)throw new Error("[remoteCamera.getCapableParticipants] Callback cannot be null");if(L(d.sidePanel),!t())throw b;_e("remoteCamera.getCapableParticipants",e)},e.requestControl=function(e,n){if(!e)throw new Error("[remoteCamera.requestControl] Participant cannot be null");if(!n)throw new Error("[remoteCamera.requestControl] Callback cannot be null");if(L(d.sidePanel),!t())throw b;_e("remoteCamera.requestControl",[e],n)},e.sendControlCommand=function(e,n){if(!e)throw new Error("[remoteCamera.sendControlCommand] ControlCommand cannot be null");if(!n)throw new Error("[remoteCamera.sendControlCommand] Callback cannot be null");if(L(d.sidePanel),!t())throw b;_e("remoteCamera.sendControlCommand",[e],n)},e.terminateSession=function(e){if(!e)throw new Error("[remoteCamera.terminateSession] Callback cannot be null");if(L(d.sidePanel),!t())throw b;_e("remoteCamera.terminateSession",e)},e.registerOnCapableParticipantsChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnCapableParticipantsChangeHandler] Handler cannot be null");if(L(d.sidePanel),!t())throw b;ee("remoteCamera.capableParticipantsChange",e)},e.registerOnErrorHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnErrorHandler] Handler cannot be null");if(L(d.sidePanel),!t())throw b;ee("remoteCamera.handlerError",e)},e.registerOnDeviceStateChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnDeviceStateChangeHandler] Handler cannot be null");if(L(d.sidePanel),!t())throw b;ee("remoteCamera.deviceStateChange",e)},e.registerOnSessionStatusChangeHandler=function(e){if(!e)throw new Error("[remoteCamera.registerOnSessionStatusChangeHandler] Handler cannot be null");if(L(d.sidePanel),!t())throw b;ee("remoteCamera.sessionStatusChange",e)},e.isSupported=t}(pt||(pt={})),function(e){function t(){return!!z.supports.appEntity}e.selectAppEntity=function(e,n,a,i){if(L(d.content),!t())throw b;if(!e||0==e.length)throw new Error("[appEntity.selectAppEntity] threadId name cannot be null or empty");if(!i)throw new Error("[appEntity.selectAppEntity] Callback cannot be null");_e("appEntity.selectAppEntity",[e,n,a],i)},e.isSupported=t}(mt||(mt={})),function(e){function t(){return!!z.supports.teams}!function(e){e[e.Regular=0]="Regular",e[e.Private=1]="Private",e[e.Shared=2]="Shared"}(e.ChannelType||(e.ChannelType={})),e.getTeamChannels=function(e,n){if(L(d.content),!t())throw b;if(!e)throw new Error("[teams.getTeamChannels] groupId cannot be null or empty");if(!n)throw new Error("[teams.getTeamChannels] Callback cannot be null");_e("teams.getTeamChannels",[e],n)},e.refreshSiteUrl=function(e,n){if(L(),!t())throw b;if(!e)throw new Error("[teams.refreshSiteUrl] threadId cannot be null or empty");if(!n)throw new Error("[teams.refreshSiteUrl] Callback cannot be null");_e("teams.refreshSiteUrl",[e],n)},e.isSupported=t,function(e){function t(){return!!z.supports.teams&&!!z.supports.teams.fullTrust}!function(e){function t(){return!!z.supports.teams&&!!z.supports.teams.fullTrust&&!!z.supports.teams.fullTrust.joinedTeams}e.getUserJoinedTeams=function(e){return new Promise(function(n){if(L(),!t())throw b;if((m.hostClientType===s.android||m.hostClientType===s.teamsRoomsAndroid||m.hostClientType===s.teamsPhones||m.hostClientType===s.teamsDisplays)&&!k("2.0.1")){var a={errorCode:r.OLD_PLATFORM};throw new Error(JSON.stringify(a))}n(le("getUserJoinedTeams",e))})},e.isSupported=t}(e.joinedTeams||(e.joinedTeams={})),e.getConfigSetting=function(e){return new Promise(function(n){if(L(),!t())throw b;n(le("getConfigSetting",e))})},e.isSupported=t}(e.fullTrust||(e.fullTrust={}))}(_t||(_t={})),function(e){function t(){return tt.isSupported()}function n(e){_e("video.notifyError",[e])}e.registerForVideoFrame=function(e,a){if(L(d.sidePanel),!t())throw b;ee("video.newVideoFrame",function(t){if(t){var a=t.timestamp;e(t,function(){!function(e){_e("video.videoFrameProcessed",[e])}(a)},n)}},!1),_e("video.registerForVideoFrame",[a])},e.notifySelectedVideoEffectChanged=function(e,n,a){if(L(d.sidePanel),!t())throw b;_e("video.videoEffectChanged",[e,n,a])},e.registerForVideoEffect=function(e){if(L(d.sidePanel),!t())throw b;ee("video.effectParameterChange",e,!1),_e("video.registerForVideoEffect")},e.updatePersonalizedEffects=function(e){if(L(d.sidePanel),!tt.isSupported())throw b;_e("video.personalizedEffectsChanged",[e])},e.isSupported=t}(ht||(ht={}))})(),i})()}).call(this,n("UvD+"))},"UvD+":function(e,t){var n,a,i=e.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(e){n=r}try{a="function"==typeof clearTimeout?clearTimeout:o}catch(e){a=o}}();var c,d=[],l=!1,u=-1;function f(){l&&c&&(l=!1,c.length?d=c.concat(d):u=-1,d.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=d.length;t;){for(c=d,d=[];++u<t;)c&&c[u].run();u=-1,t=d.length}c=null,l=!1,function(e){if(a===clearTimeout)return clearTimeout(e);if((a===o||!a)&&clearTimeout)return a=clearTimeout,clearTimeout(e);try{a(e)}catch(t){try{return a.call(null,e)}catch(t){return a.call(this,e)}}}(e)}}function m(e,t){this.fun=e,this.array=t}function _(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];d.push(new m(e,t)),1!==d.length||l||s(p)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}}}]);